<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Serenamente - Apoyo Emocional Integral</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  :root {
    --primary: #4361ee;
    --secondary: #3a0ca3;
    --accent: #4cc9f0;
    --light: #f8fafc;
    --dark: #1e293b;
    --success: #4ade80;
    --warning: #facc15;
    --danger: #f87171;
    --calm-1: #8ac6d1;
    --calm-2: #bbdefb;
    --calm-3: #b3e5fc;
    --gradient: linear-gradient(135deg, #4361ee, #3a0ca3);
    --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    --radius: 16px;
    --transition: all 0.3s ease;
  }
  /* Colores según estado de ánimo */
  .theme-duelo {
    --primary: #5b6c5d;
    --secondary: #3a4a3b;
    --accent: #7d9d80;
    --gradient: linear-gradient(135deg, #5b6c5d, #3a4a3b);
    --bg-image: url('https://images.unsplash.com/photo-1504198322253-cfa87a0ff25f?ixlib=rb-4.0.3');
  }
  .theme-ansiedad {
    --primary: #8ac6d1;
    --secondary: #4a8fa1;
    --accent: #c6e5e9;
    --gradient: linear-gradient(135deg, #8ac6d1, #4a8fa1);
    --bg-image: url('https://images.unsplash.com/photo-1519681393784-d120267933ba?ixlib=rb-4.0.3');
  }
  .theme-suicida {
    --primary: #7d3c5d;
    --secondary: #512b3b;
    --accent: #a76c89;
    --gradient: linear-gradient(135deg, #7d3c5d, #512b3b);
    --bg-image: url('https://images.unsplash.com/photo-1519327232521-1ea2c736d34d?ixlib=rb-4.0.3');
  }
  .theme-trauma {
    --primary: #6d6875;
    --secondary: #4a4458;
    --accent: #9a94a8;
    --gradient: linear-gradient(135deg, #6d6875, #4a4458);
    --bg-image: url('https://images.unsplash.com/photo-1513151233558-d860c5398176?ixlib=rb-4.0.3');
  }
  .theme-desesperanza {
    --primary: #a1887f;
    --secondary: #7d5c53;
    --accent: #d7ccc8;
    --gradient: linear-gradient(135deg, #a1887f, #7d5c53);
    --bg-image: url('https://images.unsplash.com/photo-1505142468610-359e7d316be0?ixlib=rb-4.0.3');
  }
  .theme-estres {
    --primary: #7e8d85;
    --secondary: #57655c;
    --accent: #aabdb2;
    --gradient: linear-gradient(135deg, #7e8d85, #57655c);
    --bg-image: url('https://images.unsplash.com/photo-1459411552884-841db9b3cc2a?ixlib=rb-4.0.3');
  }
  .theme-depresion {
    --primary: #5d4a7d;
    --secondary: #3a2b5c;
    --accent: #8a77ac;
    --gradient: linear-gradient(135deg, #5d4a7d, #3a2b5c);
    --bg-image: url('https://images.unsplash.com/photo-1536491253878-6e5b04f2e0ab?ixlib=rb-4.0.3');
  }
  .theme-toc {
    --primary: #7d5d5d;
    --secondary: #5c3a3a;
    --accent: #ac8a8a;
    --gradient: linear-gradient(135deg, #7d5d5d, #5c3a3a);
    --bg-image: url('https://images.unsplash.com/photo-1531373867069-d4f0619b1643?ixlib=rb-4.0.3');
  }
  .theme-panico {
    --primary: #7d7d5d;
    --secondary: #5c5c3a;
    --accent: #acac8a;
    --gradient: linear-gradient(135deg, #7d7d5d, #5c5c3a);
    --bg-image: url('https://images.unsplash.com/photo-1528852479415-9ce3297352d5?ixlib=rb-4.0.3');
  }
  .theme-default {
    --primary: #4361ee;
    --secondary: #3a0ca3;
    --accent: #4cc9f0;
    --gradient: linear-gradient(135deg, #4361ee, #3a0ca3);
    --bg-image: url('https://images.unsplash.com/photo-1518837695005-2083093ee35b?ixlib=rb-4.0.3');
  }
  .dark-mode {
    --light: #1e293b;
    --dark: #f8fafc;
    --bg-image: url('https://images.unsplash.com/photo-1532012197267-da84d127e765?ixlib=rb-4.0.3');
    filter: brightness(0.8);
  }
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }
  body {
    font-family: 'Inter', sans-serif;
    background: var(--bg-image) no-repeat center center fixed;
    background-size: cover;
    color: var(--dark);
    min-height: 100vh;
    padding: 20px;
    transition: var(--transition);
    position: relative;
  }
  body::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(255, 255, 255, 0.85);
    z-index: -1;
  }
  body.dark-mode::before {
    background: rgba(30, 41, 59, 0.9);
  }
  .container {
    background: white;
    border-radius: var(--radius);
    padding: 30px;
    max-width: 800px;
    width: 100%;
    margin: 20px auto;
    box-shadow: var(--shadow);
    position: relative;
    overflow: hidden;
    transition: var(--transition);
  }
  .dark-mode .container {
    background: #1e293b;
  }
  .container::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 6px;
    background: var(--gradient);
  }
  .hidden {
    display: none;
  }
  h1, h2, h3 {
    color: var(--secondary);
    margin-bottom: 15px;
    transition: var(--transition);
  }
  .dark-mode h1, 
  .dark-mode h2, 
  .dark-mode h3 {
    color: var(--accent);
  }
  h1 {
    font-size: 1.8rem;
    font-weight: 700;
  }
  p {
    line-height: 1.6;
    margin-bottom: 15px;
    color: #64748b;
    transition: var(--transition);
  }
  .dark-mode p {
    color: #cbd5e1;
  }
  .section-header {
    text-align: center;
    margin-bottom: 25px;
  }
  .section-header i {
    font-size: 2.5rem;
    color: var(--primary);
    margin-bottom: 15px;
    display: block;
  }
  input, textarea, button, select {
    padding: 16px;
    border-radius: 12px;
    border: 1px solid #e2e8f0;
    margin-bottom: 15px;
    font-size: 1rem;
    width: 100%;
    font-family: 'Inter', sans-serif;
    transition: var(--transition);
  }
  .dark-mode input,
  .dark-mode textarea,
  .dark-mode select {
    background: #334155;
    color: white;
    border-color: #475569;
  }
  input:focus, textarea:focus, select:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
  }
  button {
    background: var(--gradient);
    color: white;
    font-weight: 600;
    cursor: pointer;
    border: none;
    transition: var(--transition);
    position: relative;
    overflow: hidden;
  }
  button::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(255, 255, 255, 0.1);
    transform: translateX(-100%);
    transition: transform 0.3s ease;
  }
  button:hover::after {
    transform: translateX(0);
  }
  button:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 15px rgba(0,0,0,0.2);
  }
  button:disabled {
    background: #cbd5e1;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
  }
  button:disabled:hover::after {
    transform: translateX(-100%);
  }
  .btn-secondary {
    background: white;
    color: var(--primary);
    border: 2px solid var(--primary);
  }
  .dark-mode .btn-secondary {
    background: #334155;
    color: var(--accent);
    border-color: var(--accent);
  }
  .btn-secondary:hover {
    background: #f0f9ff;
  }
  .dark-mode .btn-secondary:hover {
    background: #475569;
  }
  .mood-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 15px;
    margin-top: 20px;
  }
  .mood {
    text-align: center;
    cursor: pointer;
    transition: var(--transition);
    padding: 15px 10px;
    border-radius: 12px;
    background: #f8fafc;
    border: 2px solid transparent;
  }
  .dark-mode .mood {
    background: #334155;
  }
  .mood:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow);
    border-color: var(--accent);
  }
  .mood.selected {
    transform: scale(1.05);
    border-color: var(--primary);
    background: #e0f2fe;
    box-shadow: var(--shadow);
  }
  .dark-mode .mood.selected {
    background: #475569;
  }
  .mood img {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    object-fit: contain;
    margin-bottom: 10px;
    transition: var(--transition);
  }
  .mood.selected img {
    transform: scale(1.2);
    animation: bounce 0.6s;
  }
  @keyframes bounce {
    0%, 20%, 50%, 80%, 100% {transform: translateY(0) scale(1.2);}
    40% {transform: translateY(-10px) scale(1.2);}
    60% {transform: translateY(-5px) scale(1.2);}
  }
  .technique-card {
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: var(--radius);
    padding: 25px;
    margin-bottom: 20px;
    box-shadow: var(--shadow);
    animation: fadeIn 0.5s;
  }
  .dark-mode .technique-card {
    background: #334155;
    border-color: #475569;
  }
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
  .technique-header {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
  }
  .technique-icon {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: #e0f2fe;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 15px;
    color: var(--primary);
    font-size: 1.5rem;
  }
  .dark-mode .technique-icon {
    background: #475569;
  }
  .nav-buttons {
    display: flex;
    gap: 10px;
    justify-content: space-between;
  }
  .nav-buttons button {
    width: auto;
    flex: 1;
  }
  .footer {
    text-align: center;
    margin-top: 30px;
    padding-top: 20px;
    border-top: 1px solid #e2e8f0;
    color: #64748b;
    font-size: 0.9rem;
    transition: var(--transition);
  }
  .dark-mode .footer {
    border-color: #475569;
    color: #cbd5e1;
  }
  .crisis-box {
    background: #fef2f2;
    border-radius: var(--radius);
    padding: 20px;
    text-align: center;
    margin: 20px 0;
    border-left: 4px solid var(--danger);
  }
  .dark-mode .crisis-box {
    background: #7f1d1d;
  }
  .breathing-exercise {
    text-align: center;
    margin: 20px 0;
  }
  .circle {
    width: 150px;
    height: 150px;
    border-radius: 50%;
    background: var(--gradient);
    margin: 0 auto 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.5rem;
    font-weight: bold;
    transition: all 1s ease;
  }
  .breath-controls {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-top: 20px;
  }
  .progress-bar {
    height: 6px;
    background: #e2e8f0;
    border-radius: 3px;
    margin: 20px 0;
    overflow: hidden;
  }
  .dark-mode .progress-bar {
    background: #475569;
  }
  .progress {
    height: 100%;
    background: var(--gradient);
    width: 0%;
    transition: width 0.3s ease;
  }
  .step-indicator {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin: 20px 0;
  }
  .step-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: #cbd5e1;
  }
  .step-dot.active {
    background: var(--primary);
    transform: scale(1.2);
  }
  /* Estilos para el diario */
  .journal-container {
    margin: 20px 0;
  }
  .journal-entry {
    background: #f8fafc;
    border-radius: var(--radius);
    padding: 20px;
    margin-bottom: 15px;
    border-left: 4px solid var(--primary);
    transition: var(--transition);
  }
  .dark-mode .journal-entry {
    background: #334155;
  }
  .journal-date {
    font-size: 0.9rem;
    color: #64748b;
    margin-bottom: 10px;
    transition: var(--transition);
  }
  .dark-mode .journal-date {
    color: #cbd5e1;
  }
  .journal-content {
    line-height: 1.6;
  }
  .journal-actions {
    display: flex;
    gap: 10px;
    margin-top: 15px;
  }
  .journal-actions button {
    flex: 1;
  }
  .empty-journal {
    text-align: center;
    padding: 30px;
    color: #94a3b8;
  }
  .empty-journal i {
    font-size: 3rem;
    margin-bottom: 15px;
    display: block;
    color: #cbd5e1;
  }
  /* Nuevos estilos para meditaciones */
  .meditation-card {
    background: white;
    border-radius: var(--radius);
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: var(--shadow);
    transition: var(--transition);
  }
  .dark-mode .meditation-card {
    background: #334155;
  }
  .meditation-header {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
  }
  .meditation-icon {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: #e0f2fe;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 15px;
    color: var(--primary);
    font-size: 1.5rem;
  }
  .dark-mode .meditation-icon {
    background: #475569;
  }
  .meditation-player {
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 20px 0;
  }
  .play-btn {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: var(--gradient);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.5rem;
    cursor: pointer;
    transition: var(--transition);
  }
  .play-btn:hover {
    transform: scale(1.1);
  }
  .meditation-timer {
    font-size: 1.2rem;
    font-weight: 600;
    margin-left: 15px;
    color: var(--secondary);
  }
  .dark-mode .meditation-timer {
    color: var(--accent);
  }
  /* Panel de progreso */
  .progress-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 15px;
    margin: 20px 0;
  }
  .progress-item {
    background: white;
    border-radius: var(--radius);
    padding: 15px;
    text-align: center;
    box-shadow: var(--shadow);
    transition: var(--transition);
  }
  .dark-mode .progress-item {
    background: #334155;
  }
  .progress-value {
    font-size: 2rem;
    font-weight: 700;
    color: var(--primary);
    margin: 10px 0;
  }
  .progress-label {
    font-size: 0.9rem;
    color: #64748b;
  }
  .dark-mode .progress-label {
    color: #cbd5e1;
  }
  /* Barra de navegación */
  .app-nav {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid #e2e8f0;
  }
  .dark-mode .app-nav {
    border-color: #475569;
  }
  .nav-icon {
    font-size: 1.5rem;
    color: var(--primary);
    cursor: pointer;
    transition: var(--transition);
  }
  .nav-icon:hover {
    color: var(--secondary);
  }
  .app-title {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--secondary);
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .dark-mode .app-title {
    color: var(--accent);
  }
  /* Modo oscuro */
  .theme-switch {
    position: relative;
    display: inline-block;
    width: 60px;
    height: 34px;
  }
  .theme-switch input {
    opacity: 0;
    width: 0;
    height: 0;
  }
  .slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    transition: .4s;
    border-radius: 34px;
  }
  .slider:before {
    position: absolute;
    content: "";
    height: 26px;
    width: 26px;
    left: 4px;
    bottom: 4px;
    background-color: white;
    transition: .4s;
    border-radius: 50%;
  }
  input:checked + .slider {
    background-color: var(--primary);
  }
  input:checked + .slider:before {
    transform: translateX(26px);
  }
  /* Animación de respiración */
  @keyframes breathe {
    0% { transform: scale(1); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); }
  }
  .breathing {
    animation: breathe 4s infinite;
  }
  /* Nuevos estilos para técnicas mejoradas */
  .technique-step {
    background: #f8fafc;
    border-radius: 12px;
    padding: 15px;
    margin: 10px 0;
    border-left: 3px solid var(--primary);
  }
  .dark-mode .technique-step {
    background: #475569;
  }
  .technique-resources {
    margin-top: 20px;
    padding-top: 15px;
    border-top: 1px dashed #e2e8f0;
  }
  .resource-link {
    display: block;
    padding: 10px;
    background: #f1f5f9;
    border-radius: 8px;
    margin: 8px 0;
    color: var(--primary);
    text-decoration: none;
    transition: var(--transition);
  }
  .resource-link:hover {
    background: #e0f2fe;
  }
  .dark-mode .resource-link {
    background: #475569;
    color: var(--accent);
  }
  .dark-mode .resource-link:hover {
    background: #4a5568;
  }
  /* Tarjetas de actividades */
  .activity-card {
    background: white;
    border-radius: var(--radius);
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: var(--shadow);
    transition: var(--transition);
    cursor: pointer;
  }
  .dark-mode .activity-card {
    background: #334155;
  }
  .activity-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 12px 20px -5px rgba(0, 0, 0, 0.15);
  }
  .activity-icon {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: #e0f2fe;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 15px;
    color: var(--primary);
    font-size: 1.8rem;
  }
  .dark-mode .activity-icon {
    background: #475569;
  }
  /* Estilos para el cuestionario de pensamientos */
  .thought-record {
    background: #f8fafc;
    border-radius: var(--radius);
    padding: 20px;
    margin: 20px 0;
  }
  .dark-mode .thought-record {
    background: #334155;
  }
  .thought-record h3 {
    color: var(--primary);
    margin-bottom: 20px;
    text-align: center;
  }
  .thought-field {
    margin-bottom: 15px;
  }
  .thought-field label {
    display: block;
    margin-bottom: 5px;
    font-weight: 500;
  }
  /* Estilos para el registro de hábitos */
  .habits-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 15px;
    margin: 20px 0;
  }
  .habit-card {
    background: white;
    border-radius: var(--radius);
    padding: 15px;
    text-align: center;
    box-shadow: var(--shadow);
    transition: var(--transition);
  }
  .dark-mode .habit-card {
    background: #334155;
  }
  .habit-count {
    font-size: 2rem;
    font-weight: 700;
    color: var(--primary);
    margin: 10px 0;
  }
  .habit-btn {
    width: 100%;
    padding: 10px;
    margin-top: 10px;
  }
  /* Estilos para metas */
  .goals-container {
    margin: 20px 0;
  }
  .goal-item {
    background: #f8fafc;
    border-radius: var(--radius);
    padding: 15px;
    margin-bottom: 10px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    transition: var(--transition);
  }
  .dark-mode .goal-item {
    background: #334155;
  }
  .goal-text {
    flex: 1;
    margin-right: 15px;
  }
  .goal-completed {
    text-decoration: line-through;
    color: #94a3b8;
  }
  .dark-mode .goal-completed {
    color: #64748b;
  }
  .goal-actions button {
    margin-left: 5px;
    padding: 5px 10px;
    font-size: 0.9rem;
  }
  /* Estilos para gráficos */
  .chart-container {
    height: 200px;
    background: #f1f5f9;
    border-radius: var(--radius);
    margin: 20px 0;
    display: flex;
    align-items: flex-end;
    justify-content: space-around;
    padding: 20px 10px;
  }
  .dark-mode .chart-container {
    background: #334155;
  }
  .chart-bar {
    width: 30px;
    background: var(--primary);
    border-radius: 5px 5px 0 0;
    transition: height 0.5s ease;
    position: relative;
  }
  .chart-label {
    position: absolute;
    bottom: -25px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 0.8rem;
    color: #64748b;
  }
  .dark-mode .chart-label {
    color: #cbd5e1;
  }
  /* Estilos para alertas de riesgo */
  .risk-indicator {
    padding: 15px;
    border-radius: var(--radius);
    margin: 20px 0;
    display: flex;
    align-items: center;
  }
  .risk-low {
    background: #dcfce7;
    border-left: 4px solid #22c55e;
  }
  .risk-medium {
    background: #fef9c3;
    border-left: 4px solid #eab308;
  }
  .risk-high {
    background: #fed7aa;
    border-left: 4px solid #ea580c;
  }
  .risk-critical {
    background: #fee2e2;
    border-left: 4px solid #ef4444;
  }
  .dark-mode .risk-low {
    background: #166534;
  }
  .dark-mode .risk-medium {
    background: #713f12;
  }
  .dark-mode .risk-high {
    background: #9a3412;
  }
  .dark-mode .risk-critical {
    background: #991b1b;
  }
  .risk-icon {
    font-size: 1.5rem;
    margin-right: 15px;
  }
  .risk-low .risk-icon {
    color: #22c55e;
  }
  .risk-medium .risk-icon {
    color: #eab308;
  }
  .risk-high .risk-icon {
    color: #ea580c;
  }
  .risk-critical .risk-icon {
    color: #ef4444;
  }
  /* Estilos para el módulo de audioterapia */
  .audiotherapy-section {
    padding: 20px;
    background: #f8fafc;
    border-radius: var(--radius);
    margin: 20px 0;
    transition: var(--transition);
  }
  .dark-mode .audiotherapy-section {
    background: #334155;
  }
  .audio-card {
    background: white;
    border-radius: var(--radius);
    padding: 20px;
    margin-bottom: 15px;
    box-shadow: var(--shadow);
    transition: var(--transition);
  }
  .dark-mode .audio-card {
    background: #475569;
  }
  .audio-header {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
  }
  .audio-icon {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: #e0f2fe;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 15px;
    color: var(--primary);
    font-size: 1.5rem;
  }
  .dark-mode .audio-icon {
    background: #475569;
  }
  .audio-player {
    display: flex;
    align-items: center;
    gap: 15px;
    margin: 15px 0;
  }
  .audio-controls {
    display: flex;
    gap: 10px;
  }
  .audio-control-btn {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: var(--primary);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: var(--transition);
  }
  .audio-control-btn:hover {
    transform: scale(1.1);
  }
  .volume-slider {
    flex: 1;
    -webkit-appearance: none;
    height: 5px;
    border-radius: 5px;
    background: #e2e8f0;
    outline: none;
  }
  .dark-mode .volume-slider {
    background: #475569;
  }
  .volume-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 15px;
    height: 15px;
    border-radius: 50%;
    background: var(--primary);
    cursor: pointer;
  }
  .audio-duration {
    font-size: 0.9rem;
    color: #64748b;
    margin-left: 15px;
  }
  .dark-mode .audio-duration {
    color: #cbd5e1;
  }
  .audio-description {
    font-size: 0.9rem;
    color: #64748b;
    margin-top: 10px;
    line-height: 1.5;
  }
  .dark-mode .audio-description {
    color: #cbd5e1;
  }
  
  /* Estilos para módulos avanzados de terapia */
  .distortion-list {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
    margin: 20px 0;
  }
  .distortion-item {
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: var(--radius);
    padding: 15px;
    cursor: pointer;
    transition: var(--transition);
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .dark-mode .distortion-item {
    background: #334155;
    border-color: #475569;
  }
  .distortion-item:hover {
    border-color: var(--primary);
    transform: translateY(-2px);
    box-shadow: var(--shadow);
  }
  .distortion-item i {
    color: var(--primary);
    font-size: 1.2rem;
  }
  .abc-record {
    background: #f8fafc;
    border-radius: var(--radius);
    padding: 20px;
    margin: 20px 0;
  }
  .dark-mode .abc-record {
    background: #334155;
  }
  .behavior-tracking {
    background: #f8fafc;
    border-radius: var(--radius);
    padding: 20px;
    margin: 20px 0;
  }
  .dark-mode .behavior-tracking {
    background: #334155;
  }
  .tracking-input {
    margin: 15px 0;
    display: flex;
    align-items: center;
    gap: 15px;
    flex-wrap: wrap;
  }
  .tracking-input label {
    min-width: 200px;
    font-weight: 500;
  }
  .tracking-input input[type="range"] {
    flex: 1;
    max-width: 200px;
  }
  .tracking-input span {
    min-width: 30px;
    font-weight: bold;
    color: var(--primary);
  }
  .behavior-log {
    margin-top: 30px;
    padding-top: 20px;
    border-top: 1px solid #e2e8f0;
  }
  .dark-mode .behavior-log {
    border-color: #475569;
  }
  .behavior-entry {
    background: white;
    border-radius: var(--radius);
    padding: 15px;
    margin-bottom: 10px;
    border-left: 4px solid var(--primary);
  }
  .dark-mode .behavior-entry {
    background: #475569;
  }
  .values-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 15px;
    margin: 20px 0;
  }
  .value-card {
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: var(--radius);
    padding: 15px;
    text-align: center;
    cursor: pointer;
    transition: var(--transition);
  }
  .dark-mode .value-card {
    background: #334155;
    border-color: #475569;
  }
  .value-card:hover {
    border-color: var(--primary);
    transform: translateY(-2px);
    box-shadow: var(--shadow);
  }
  .value-card.selected {
    border-color: var(--primary);
    background: #e0f2fe;
  }
  .dark-mode .value-card.selected {
    background: #475569;
  }
  .music-library {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin: 20px 0;
  }
  .music-card {
    background: white;
    border-radius: var(--radius);
    padding: 20px;
    box-shadow: var(--shadow);
    transition: var(--transition);
  }
  .dark-mode .music-card {
    background: #334155;
  }
  .music-header {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
  }
  .music-icon {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: #e0f2fe;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 15px;
    color: var(--primary);
    font-size: 1.5rem;
  }
  .dark-mode .music-icon {
    background: #475569;
  }
  .music-controls {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin: 15px 0;
  }
  .frequency-display {
    text-align: center;
    font-size: 1.2rem;
    font-weight: bold;
    color: var(--primary);
    margin: 15px 0;
  }
  
  /* Estilos adicionales para módulos de terapia */
  .mindfulness-exercise, .walking-meditation, .progressive-relaxation {
    margin: 20px 0;
  }
  .mindful-eating-guide {
    margin: 20px 0;
  }
  .sense-instruction {
    text-align: center;
    font-size: 1.1rem;
    padding: 20px;
    background: #f0f9ff;
    border-radius: var(--radius);
    margin: 15px 0;
  }
  .dark-mode .sense-instruction {
    background: #475569;
  }
  .metronome-controls {
    display: flex;
    align-items: center;
    gap: 15px;
    margin: 15px 0;
    flex-wrap: wrap;
  }
  .rhythm-breathing {
    margin: 20px 0;
  }
  .vocalization-exercises {
    margin: 20px 0;
  }
  .mantras-list {
    margin: 15px 0;
  }
  .mantra-item {
    background: #f8fafc;
    border: 1px solid #e2e8f0;
    border-radius: var(--radius);
    padding: 15px;
    margin: 10px 0;
    cursor: pointer;
    transition: var(--transition);
  }
  .dark-mode .mantra-item {
    background: #334155;
    border-color: #475569;
  }
  .mantra-item:hover {
    border-color: var(--primary);
    transform: translateY(-2px);
    box-shadow: var(--shadow);
  }
  .vowel-toning {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    justify-content: center;
    margin: 15px 0;
  }
  .receptive-music {
    margin: 20px 0;
  }
  .mood-music-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 15px;
    margin: 20px 0;
  }
  .mood-music-btn {
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: var(--radius);
    padding: 15px 10px;
    cursor: pointer;
    transition: var(--transition);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
  }
  .dark-mode .mood-music-btn {
    background: #334155;
    border-color: #475569;
    color: white;
  }
  .mood-music-btn:hover {
    border-color: var(--primary);
    transform: translateY(-2px);
    box-shadow: var(--shadow);
  }
  .mood-music-btn i {
    font-size: 1.5rem;
    color: var(--primary);
  }
  .assessment-questions {
    margin: 20px 0;
  }
  .question-item {
    background: #f8fafc;
    border-radius: var(--radius);
    padding: 15px;
    margin: 10px 0;
    display: flex;
    align-items: center;
    gap: 15px;
    flex-wrap: wrap;
  }
  .dark-mode .question-item {
    background: #334155;
  }
  .question-item p {
    flex: 1;
    margin: 0;
    min-width: 300px;
  }
  .question-item input[type="range"] {
    width: 100px;
  }
  .question-item span {
    min-width: 30px;
    font-weight: bold;
    color: var(--primary);
  }
  .flexibility-result {
    text-align: center;
    margin: 20px 0;
    padding: 20px;
    background: #f0f9ff;
    border-radius: var(--radius);
  }
  .dark-mode .flexibility-result {
    background: #475569;
  }
  
  @media (max-width: 600px) {
    .container {
      padding: 20px;
    }
    h1 {
      font-size: 1.5rem;
    }
    .mood-container {
      grid-template-columns: repeat(2, 1fr);
    }
    .mood img {
      width: 70px;
      height: 70px;
    }
    .nav-buttons {
      flex-direction: column;
    }
    .app-nav {
      flex-direction: column;
      gap: 15px;
    }
    .progress-grid, .habits-grid {
      grid-template-columns: 1fr;
    }
    .chart-container {
      height: 150px;
    }
    .distortion-list {
      grid-template-columns: 1fr;
    }
    .values-grid {
      grid-template-columns: repeat(2, 1fr);
    }
    .music-library {
      grid-template-columns: 1fr;
    }
    .tracking-input {
      flex-direction: column;
      align-items: flex-start;
    }
    .tracking-input label {
      min-width: auto;
    }
    .mood-music-grid {
      grid-template-columns: repeat(2, 1fr);
    }
    .metronome-controls {
      flex-direction: column;
      align-items: flex-start;
    }
    .vowel-toning {
      flex-direction: column;
    }
    .question-item {
      flex-direction: column;
      align-items: flex-start;
    }
    .question-item p {
      min-width: auto;
    }
  }
</style>
</head>
<body class="theme-default">
<div class="container">
  <!-- Barra de navegación -->
  <div class="app-nav">
    <div class="app-title">
      <i class="fas fa-spa"></i>
      <span>Serenamente</span>
    </div>
    <div style="display: flex; align-items: center; gap: 15px;">
      <label class="theme-switch">
        <input type="checkbox" id="darkModeToggle">
        <span class="slider"></span>
      </label>
      <i class="fas fa-moon nav-icon"></i>
    </div>
  </div>
  <!-- Consentimiento -->
  <section id="consent-section">
    <div class="section-header">
      <i class="fas fa-hands-helping"></i>
      <h1>Bienvenido/a a Serenamente 👋</h1>
    </div>
    <p>Esta aplicación ofrece apoyo emocional inicial mediante técnicas basadas en evidencia científica, pero <strong>no reemplaza la atención profesional</strong>.</p>
    <div class="crisis-box">
      <p><i class="fas fa-exclamation-triangle"></i> Si estás en crisis, llamá inmediatamente al:</p>
      <h3>0800 345 1435</h3>
      <p>Centro de Asistencia al Suicida - Disponible 8 a 00 hs</p>
    </div>
    <label><input type="checkbox" id="consentCheck"> Acepto continuar y entiendo esta advertencia</label>
    <button id="consentBtn" disabled onclick="nextStep('consent-section','name-section')">Continuar</button>
  </section>
  <!-- Nombre y malestar -->
  <section id="name-section" class="hidden">
    <div class="section-header">
      <i class="fas fa-user-circle"></i>
      <h1>¿Cómo te llamás?</h1>
    </div>
    <input type="text" id="userName" placeholder="Escribí tu nombre">
    <h2>¿Qué te preocupa hoy?</h2>
    <textarea id="userMood" placeholder="Describí brevemente lo que estás experimentando..." rows="3"></textarea>
    <button onclick="saveName()">Siguiente</button>
  </section>
  <!-- Estado de ánimo -->
  <section id="mood-section" class="hidden">
    <div class="section-header">
      <h1>Hola <span id="displayName"></span> 👋</h1>
      <p>¿Cómo te sentís hoy?</p>
    </div>
    <div class="mood-container">
      <div class="mood" data-value="duelo">
        <img src="https://cdn-icons-png.flaticon.com/512/3586/3586985.png" alt="Duelo">
        <p>Estoy en duelo</p>
      </div>
      <div class="mood" data-value="ansiedad">
        <img src="https://cdn-icons-png.flaticon.com/512/10591/10591942.png" alt="Ansiedad">
        <p>Siento ansiedad</p>
      </div>
      <div class="mood" data-value="suicida">
        <img src="https://cdn-icons-png.flaticon.com/512/10591/10591952.png" alt="Crisis">
        <p>Tengo pensamientos suicidas</p>
      </div>
      <div class="mood" data-value="trauma">
        <img src="https://cdn-icons-png.flaticon.com/512/10591/10591957.png" alt="Trauma">
        <p>Estoy afectado por un trauma</p>
      </div>
      <div class="mood" data-value="desesperanza">
        <img src="https://cdn-icons-png.flaticon.com/512/10591/10591949.png" alt="Desesperanza">
        <p>Me siento desesperanzado/a</p>
      </div>
      <div class="mood" data-value="estres">
        <img src="https://cdn-icons-png.flaticon.com/512/10591/10591954.png" alt="Estrés">
        <p>Estoy estresado/a</p>
      </div>
      <div class="mood" data-value="depresion">
        <img src="https://cdn-icons-png.flaticon.com/512/10591/10591946.png" alt="Depresión">
        <p>Estoy deprimido/a</p>
      </div>
      <div class="mood" data-value="toc">
        <img src="https://cdn-icons-png.flaticon.com/512/10591/10591956.png" alt="TOC">
        <p>Tengo TOC</p>
      </div>
      <div class="mood" data-value="panico">
        <img src="https://cdn-icons-png.flaticon.com/512/10591/10591953.png" alt="Pánico">
        <p>Tengo ataques de pánico</p>
      </div>
    </div>
    <div class="progress-bar">
      <div class="progress" style="width: 33%"></div>
    </div>
    <div class="step-indicator">
      <div class="step-dot"></div>
      <div class="step-dot active"></div>
      <div class="step-dot"></div>
    </div>
  </section>
  <!-- Crisis -->
  <section id="crisis-section" class="hidden">
    <div class="crisis-box">
      <div class="section-header">
        <i class="fas fa-life-ring"></i>
        <h2>Estamos acá para ayudarte 💙</h2>
      </div>
      <p>No estás solo/a. Podés llamar ya al:</p>
      <p><strong>Centro de Asistencia al Suicida</strong><br>0800 345 1435<br>Horario: 8 a 00 hs</p>
      <div class="nav-buttons">
        <button class="btn-secondary" onclick="nextStep('crisis-section','mood-section')">Volver</button>
        <button onclick="window.location.href='tel:08003451435'"><i class="fas fa-phone"></i> Llamar ahora</button>
      </div>
      <p style="margin-top: 15px;">También podés contactar con:</p>
      <p><strong>Línea de prevención suicide</strong><br>135 (todo el país)</p>
      <button onclick="nextStep('crisis-section','techniques-section')">Ver técnicas de apoyo</button>
    </div>
  </section>
  <!-- Técnicas -->
  <section id="techniques-section" class="hidden">
    <div class="section-header">
      <i class="fas fa-heart"></i>
      <h1>Técnicas de Apoyo Emocional</h1>
      <p>Seleccioná una técnica para empezar:</p>
    </div>
    <div id="technique-content" class="technique-card"></div>
    <div class="nav-buttons">
      <button id="prevBtn" onclick="prevTechnique()" disabled><i class="fas fa-arrow-left"></i> Anterior</button>
      <button id="nextBtn" onclick="nextTechnique()">Siguiente <i class="fas fa-arrow-right"></i></button>
    </div>
    <div class="progress-bar">
      <div class="progress" id="technique-progress"></div>
    </div>
    <div class="nav-buttons">
      <button class="btn-secondary" onclick="nextStep('techniques-section','mood-section')">Volver al inicio</button>
      <button onclick="nextStep('techniques-section','cbt-module-section')"><i class="fas fa-brain"></i> TCC Avanzada</button>
      <button onclick="nextStep('techniques-section','mindfulness-module-section')"><i class="fas fa-leaf"></i> Mindfulness</button>
      <button onclick="nextStep('techniques-section','act-module-section')"><i class="fas fa-compass"></i> ACT</button>
      <button onclick="nextStep('techniques-section','music-therapy-section')"><i class="fas fa-music"></i> Musicoterapia</button>
      <button onclick="nextStep('techniques-section','meditation-section')"><i class="fas fa-meditation"></i> Meditaciones</button>
      <button onclick="nextStep('techniques-section','activities-section')"><i class="fas fa-hands-helping"></i> Actividades</button>
    </div>
  </section>
  <!-- Meditaciones -->
  <section id="meditation-section" class="hidden">
    <div class="section-header">
      <i class="fas fa-music"></i>
      <h1>Meditaciones Guiadas</h1>
      <p>Seleccioná una meditación para relajar tu mente:</p>
    </div>
    <div class="meditation-card">
      <div class="meditation-header">
        <div class="meditation-icon">
          <i class="fas fa-wind"></i>
        </div>
        <h3>Respiración Consciente</h3>
      </div>
      <p>Meditación de 5 minutos para centrarte en tu respiración y calmar la mente.</p>
      <div class="meditation-player">
        <div class="play-btn" onclick="toggleBreathing()">
          <i class="fas fa-play" id="breath-play-icon"></i>
        </div>
        <div class="meditation-timer" id="breath-timer">05:00</div>
      </div>
      <div class="circle breathing hidden" id="breath-circle">Inhalar</div>
    </div>
    <div class="meditation-card">
      <div class="meditation-header">
        <div class="meditation-icon">
          <i class="fas fa-mountain"></i>
        </div>
        <h3>Relajación Corporal</h3>
      </div>
      <p>Meditación de 10 minutos para liberar tensiones físicas y mentales.</p>
      <div class="meditation-player">
        <div class="play-btn" onclick="toggleBodyScan()">
          <i class="fas fa-play" id="bodyscan-play-icon"></i>
        </div>
        <div class="meditation-timer" id="bodyscan-timer">10:00</div>
      </div>
    </div>
    <div class="meditation-card">
      <div class="meditation-header">
        <div class="meditation-icon">
          <i class="fas fa-leaf"></i>
        </div>
        <h3>Mindfulness</h3>
      </div>
      <p>Meditación de 8 minutos para practicar atención plena y reducir el estrés.</p>
      <div class="meditation-player">
        <div class="play-btn" onclick="toggleMindfulness()">
          <i class="fas fa-play" id="mindfulness-play-icon"></i>
        </div>
        <div class="meditation-timer" id="mindfulness-timer">08:00</div>
      </div>
    </div>
    <div class="nav-buttons">
      <button class="btn-secondary" onclick="nextStep('meditation-section','techniques-section')"><i class="fas fa-arrow-left"></i> Volver a técnicas</button>
      <button onclick="nextStep('meditation-section','audiotherapy-section')"><i class="fas fa-headphones"></i> Audioterapia</button>
    </div>
  </section>
  <!-- Audioterapia -->
  <section id="audiotherapy-section" class="hidden">
    <div class="section-header">
      <i class="fas fa-headphones"></i>
      <h1>Audioterapia Curativa</h1>
      <p>Seleccioná un sonido terapéutico para calmar tu mente y cuerpo:</p>
    </div>
    <div class="audiotherapy-section">
      <div class="audio-card">
        <div class="audio-header">
          <div class="audio-icon">
            <i class="fas fa-water"></i>
          </div>
          <div>
            <h3>Sonidos de Agua</h3>
            <p>Olás del mar, lluvia suave, arroyos</p>
          </div>
        </div>
        <div class="audio-description">
          Los sonidos de agua tienen un efecto calmante en el sistema nervioso, reduciendo los niveles de cortisol (hormona del estrés) y promoviendo la relajación profunda. Ideal para ansiedad y estrés.
        </div>
        <div class="audio-player">
          <div class="audio-controls">
            <button class="audio-control-btn" onclick="toggleAudio('water')">
              <i class="fas fa-play" id="water-play-icon"></i>
            </button>
            <button class="audio-control-btn" onclick="stopAudio('water')">
              <i class="fas fa-stop"></i>
            </button>
          </div>
          <input type="range" class="volume-slider" id="water-volume" min="0" max="1" step="0.1" value="0.7">
          <div class="audio-duration" id="water-duration">00:00 / 60:00</div>
        </div>
      </div>
      
      <div class="audio-card">
        <div class="audio-header">
          <div class="audio-icon">
            <i class="fas fa-tree"></i>
          </div>
          <div>
            <h3>Sonidos de la Naturaleza</h3>
            <p>Bosques, pájaros, viento en los árboles</p>
          </div>
        </div>
        <div class="audio-description">
          La biofilia, nuestra conexión innata con la naturaleza, se activa con estos sonidos. Estudios muestran que reducen la presión arterial, mejoran el estado de ánimo y aumentan la sensación de bienestar. Perfecto para duelo y desesperanza.
        </div>
        <div class="audio-player">
          <div class="audio-controls">
            <button class="audio-control-btn" onclick="toggleAudio('nature')">
              <i class="fas fa-play" id="nature-play-icon"></i>
            </button>
            <button class="audio-control-btn" onclick="stopAudio('nature')">
              <i class="fas fa-stop"></i>
            </button>
          </div>
          <input type="range" class="volume-slider" id="nature-volume" min="0" max="1" step="0.1" value="0.7">
          <div class="audio-duration" id="nature-duration">00:00 / 60:00</div>
        </div>
      </div>
      
      <div class="audio-card">
        <div class="audio-header">
          <div class="audio-icon">
            <i class="fas fa-music"></i>
          </div>
          <div>
            <h3>Música Binaural</h3>
            <p>Frecuencias para equilibrar ondas cerebrales</p>
          </div>
        </div>
        <div class="audio-description">
          Las frecuencias binaurales sincronizan las ondas cerebrales, induciendo estados de relajación profunda (theta) o meditación (alpha). Eficaz para insomnio, ansiedad y concentración. Usa audífonos para mejor efecto.
        </div>
        <div class="audio-player">
          <div class="audio-controls">
            <button class="audio-control-btn" onclick="toggleAudio('binaural')">
              <i class="fas fa-play" id="binaural-play-icon"></i>
            </button>
            <button class="audio-control-btn" onclick="stopAudio('binaural')">
              <i class="fas fa-stop"></i>
            </button>
          </div>
          <input type="range" class="volume-slider" id="binaural-volume" min="0" max="1" step="0.1" value="0.7">
          <div class="audio-duration" id="binaural-duration">00:00 / 30:00</div>
        </div>
      </div>
      
      <div class="audio-card">
        <div class="audio-header">
          <div class="audio-icon">
            <i class="fas fa-moon"></i>
          </div>
          <div>
            <h3>Sonidos para Dormir</h3>
            <p>Ruido blanco, rosa y marrón</p>
          </div>
        </div>
        <div class="audio-description">
          El ruido rosa y marrón son especialmente efectivos para mejorar la calidad del sueño, al enmascarar sonidos disruptivos y promover ondas cerebrales delta. Recomendado para insomnio y estrés.
        </div>
        <div class="audio-player">
          <div class="audio-controls">
            <button class="audio-control-btn" onclick="toggleAudio('sleep')">
              <i class="fas fa-play" id="sleep-play-icon"></i>
            </button>
            <button class="audio-control-btn" onclick="stopAudio('sleep')">
              <i class="fas fa-stop"></i>
            </button>
          </div>
          <input type="range" class="volume-slider" id="sleep-volume" min="0" max="1" step="0.1" value="0.7">
          <div class="audio-duration" id="sleep-duration">00:00 / 120:00</div>
        </div>
      </div>
      
      <div class="audio-card">
        <div class="audio-header">
          <div class="audio-icon">
            <i class="fas fa-spa"></i>
          </div>
          <div>
            <h3>Tibetan Singing Bowls</h3>
            <p>Sonidos armónicos de cuencos tibetanos</p>
          </div>
        </div>
        <div class="audio-description">
          Los cuencos tibetanos producen armónicos que resuenan con el cuerpo, promoviendo la relajación profunda y la meditación. Estudios muestran reducción significativa de ansiedad y mejora en la calidad de vida.
        </div>
        <div class="audio-player">
          <div class="audio-controls">
            <button class="audio-control-btn" onclick="toggleAudio('tibetan')">
              <i class="fas fa-play" id="tibetan-play-icon"></i>
            </button>
            <button class="audio-control-btn" onclick="stopAudio('tibetan')">
              <i class="fas fa-stop"></i>
            </button>
          </div>
          <input type="range" class="volume-slider" id="tibetan-volume" min="0" max="1" step="0.1" value="0.7">
          <div class="audio-duration" id="tibetan-duration">00:00 / 45:00</div>
        </div>
      </div>
    </div>
    <div class="nav-buttons">
      <button class="btn-secondary" onclick="nextStep('audiotherapy-section','meditation-section')"><i class="fas fa-arrow-left"></i> Volver a meditaciones</button>
      <button onclick="nextStep('audiotherapy-section','progress-section')"><i class="fas fa-chart-line"></i> Ver mi progreso</button>
    </div>
  </section>
  <!-- Panel de Progreso -->
  <section id="progress-section" class="hidden">
    <div class="section-header">
      <i class="fas fa-chart-line"></i>
      <h1>Mi Progreso</h1>
      <p>Seguimiento de tu bienestar emocional:</p>
    </div>
    
    <!-- Risk Indicator -->
    <div id="risk-indicator" class="risk-indicator risk-low hidden">
      <i class="fas fa-check-circle risk-icon"></i>
      <div>
        <h3 class="font-bold">Nivel de Riesgo: Bajo</h3>
        <p>Continuá con tus prácticas de autocuidado.</p>
      </div>
    </div>
    
    <div class="progress-grid">
      <div class="progress-item">
        <i class="fas fa-calendar-check" style="font-size: 2rem; color: var(--primary);"></i>
        <div class="progress-value" id="days-tracked">0</div>
        <div class="progress-label">Días registrados</div>
      </div>
      <div class="progress-item">
        <i class="fas fa-pen-fancy" style="font-size: 2rem; color: var(--primary);"></i>
        <div class="progress-value" id="entries-count">0</div>
        <div class="progress-label">Entradas en diario</div>
      </div>
      <div class="progress-item">
        <i class="fas fa-medal" style="font-size: 2rem; color: var(--primary);"></i>
        <div class="progress-value" id="techniques-tried">0</div>
        <div class="progress-label">Técnicas probadas</div>
      </div>
    </div>
    
    <h2>Tu estado de ánimo esta semana</h2>
    <div class="chart-container" id="mood-chart">
      <!-- Las barras se generarán dinámicamente con JavaScript -->
    </div>
    
    <h2 class="mt-8">Tus hábitos saludables</h2>
    <div class="habits-grid">
      <div class="habit-card">
        <i class="fas fa-running" style="font-size: 2rem; color: var(--primary);"></i>
        <div class="habit-count" id="exercise-count">0</div>
        <div class="progress-label">Ejercicio</div>
        <button class="habit-btn" onclick="recordHabit('exercise')">Registrar hoy</button>
      </div>
      <div class="habit-card">
        <i class="fas fa-brain" style="font-size: 2rem; color: var(--primary);"></i>
        <div class="habit-count" id="meditation-count">0</div>
        <div class="progress-label">Meditación</div>
        <button class="habit-btn" onclick="recordHabit('meditation')">Registrar hoy</button>
      </div>
      <div class="habit-card">
        <i class="fas fa-tree" style="font-size: 2rem; color: var(--primary);"></i>
        <div class="habit-count" id="nature-count">0</div>
        <div class="progress-label">Naturaleza</div>
        <button class="habit-btn" onclick="recordHabit('nature')">Registrar hoy</button>
      </div>
      <div class="habit-card">
        <i class="fas fa-heart" style="font-size: 2rem; color: var(--primary);"></i>
        <div class="habit-count" id="gratitude-count">0</div>
        <div class="progress-label">Gratitud</div>
        <button class="habit-btn" onclick="recordHabit('gratitude')">Registrar hoy</button>
      </div>
    </div>
    
    <h2 class="mt-8">Tus metas</h2>
    <div class="goals-container">
      <div class="mb-4">
        <input type="text" id="goalInput" placeholder="Ej: Meditar 3 veces por semana" class="w-full">
        <button onclick="addGoal()" class="w-full mt-2">Agregar meta</button>
      </div>
      <div id="goals-list">
        <!-- Las metas se generarán dinámicamente con JavaScript -->
      </div>
    </div>
    
    <div class="nav-buttons">
      <button class="btn-secondary" onclick="nextStep('progress-section','audiotherapy-section')"><i class="fas fa-arrow-left"></i> Volver a audioterapia</button>
      <button onclick="nextStep('progress-section','journal-section')"><i class="fas fa-book"></i> Ir al diario</button>
    </div>
  </section>
  <!-- Diario Personal -->
  <section id="journal-section" class="hidden">
    <div class="section-header">
      <i class="fas fa-book"></i>
      <h1>Mi Diario Personal</h1>
      <p>Escribí tus pensamientos y sentimientos. Podés descargarlos luego.</p>
    </div>
    <div class="journal-container">
      <textarea id="journalEntry" placeholder="¿Cómo te sentís hoy? Escribí lo que necesites expresar..." rows="6"></textarea>
      <button onclick="saveJournalEntry()"><i class="fas fa-save"></i> Guardar entrada</button>
    </div>
    <h2>Tus entradas anteriores</h2>
    <div id="journal-entries">
      <div class="empty-journal">
        <i class="fas fa-book-open"></i>
        <p>No tenés entradas en tu diario todavía.</p>
      </div>
    </div>
    <div class="nav-buttons">
      <button class="btn-secondary" onclick="nextStep('journal-section','progress-section')"><i class="fas fa-arrow-left"></i> Volver a progreso</button>
      <button onclick="downloadJournal()"><i class="fas fa-download"></i> Descargar diario</button>
    </div>
  </section>
  <!-- Actividades de bienestar -->
  <section id="activities-section" class="hidden">
    <div class="section-header">
      <i class="fas fa-hands-helping"></i>
      <h1>Actividades de Bienestar</h1>
      <p>Seleccioná una actividad para mejorar tu estado de ánimo:</p>
    </div>
    <div class="activity-card" onclick="startActivity('gratitude')">
      <div class="activity-icon">
        <i class="fas fa-heart"></i>
      </div>
      <h3>Diario de Gratitud</h3>
      <p>Escribe tres cosas por las que estés agradecido hoy</p>
    </div>
    <div class="activity-card" onclick="startActivity('pleasure')">
      <div class="activity-icon">
        <i class="fas fa-smile"></i>
      </div>
      <h3>Actividades Placenteras</h3>
      <p>Planifica actividades que disfrutes para los próximos días</p>
    </div>
    <div class="activity-card" onclick="startActivity('cognitive')">
      <div class="activity-icon">
        <i class="fas fa-brain"></i>
      </div>
      <h3>Registro de Pensamientos</h3>
      <p>Identifica y desafía pensamientos negativos automáticos</p>
    </div>
    <div class="activity-card" onclick="nextStep('activities-section','thought-record-section')">
      <div class="activity-icon">
        <i class="fas fa-file-alt"></i>
      </div>
      <h3>Hoja de Trabajo Cognitiva</h3>
      <p>Completa una hoja estructurada para reestructurar pensamientos</p>
    </div>
    <div class="activity-card" onclick="nextStep('activities-section','audiotherapy-section')">
      <div class="activity-icon">
        <i class="fas fa-headphones"></i>
      </div>
      <h3>Audioterapia Curativa</h3>
      <p>Escucha sonidos terapéuticos para calmar tu mente</p>
    </div>
    <div class="nav-buttons">
      <button class="btn-secondary" onclick="nextStep('activities-section','techniques-section')"><i class="fas fa-arrow-left"></i> Volver a técnicas</button>
      <button onclick="nextStep('activities-section','journal-section')"><i class="fas fa-book"></i> Ir al diario</button>
    </div>
  </section>
  
  <!-- Registro de Pensamientos -->
  <section id="thought-record-section" class="hidden">
    <div class="section-header">
      <i class="fas fa-brain"></i>
      <h1>Registro de Pensamientos</h1>
      <p>Identificá y desafía pensamientos negativos automáticos</p>
    </div>
    <div class="thought-record">
      <div class="thought-field">
        <label for="situation">Situación:</label>
        <input type="text" id="situation" placeholder="Describe brevemente la situación que desencadenó el pensamiento">
      </div>
      <div class="thought-field">
        <label for="emotion">Emoción:</label>
        <input type="text" id="emotion" placeholder="¿Qué emoción sentiste? (tristeza, ira, ansiedad, etc.)">
      </div>
      <div class="thought-field">
        <label for="automaticThought">Pensamiento automático:</label>
        <textarea id="automaticThought" rows="3" placeholder="¿Qué pensamiento automático tuviste? (Ej: 'Soy un fracaso', 'Nunca podré superar esto')"></textarea>
      </div>
      <div class="thought-field">
        <label for="evidenceFor">Evidencia a favor del pensamiento:</label>
        <textarea id="evidenceFor" rows="3" placeholder="¿Qué evidencia apoya este pensamiento?"></textarea>
      </div>
      <div class="thought-field">
        <label for="evidenceAgainst">Evidencia en contra del pensamiento:</label>
        <textarea id="evidenceAgainst" rows="3" placeholder="¿Qué evidencia contradice este pensamiento?"></textarea>
      </div>
      <div class="thought-field">
        <label for="balancedThought">Pensamiento más equilibrado:</label>
        <textarea id="balancedThought" rows="3" placeholder="¿Qué pensamiento más equilibrado y realista podrías tener?"></textarea>
      </div>
      <div class="nav-buttons">
        <button class="btn-secondary" onclick="nextStep('thought-record-section','activities-section')"><i class="fas fa-arrow-left"></i> Volver</button>
        <button onclick="saveThoughtRecord()"><i class="fas fa-save"></i> Guardar en diario</button>
      </div>
    </div>
  </section>
  
  <!-- Módulo TCC Avanzada -->
  <section id="cbt-module-section" class="hidden">
    <div class="section-header">
      <i class="fas fa-brain"></i>
      <h1>Terapia Cognitivo-Conductual Avanzada</h1>
      <p>Herramientas científicamente validadas para identificar y modificar patrones de pensamiento negativos</p>
    </div>
    
    <div class="technique-card">
      <div class="technique-header">
        <div class="technique-icon">
          <i class="fas fa-magnifying-glass"></i>
        </div>
        <h3>Identificación de Distorsiones Cognitivas</h3>
      </div>
      <p>Aprende a reconocer los 10 tipos más comunes de pensamientos distorsionados que pueden afectar tu bienestar emocional.</p>
      
      <div class="distortion-list">
        <div class="distortion-item" onclick="showDistortionInfo('catastrophizing')">
          <i class="fas fa-bolt"></i>
          <span>Catastrofización</span>
        </div>
        <div class="distortion-item" onclick="showDistortionInfo('allOrNothing')">
          <i class="fas fa-balance-scale"></i>
          <span>Pensamiento Todo o Nada</span>
        </div>
        <div class="distortion-item" onclick="showDistortionInfo('mindReading')">
          <i class="fas fa-head-side-brain"></i>
          <span>Lectura Mental</span>
        </div>
        <div class="distortion-item" onclick="showDistortionInfo('personalization')">
          <i class="fas fa-user-circle"></i>
          <span>Personalización</span>
        </div>
        <div class="distortion-item" onclick="showDistortionInfo('filtering')">
          <i class="fas fa-filter"></i>
          <span>Filtro Mental</span>
        </div>
        <div class="distortion-item" onclick="showDistortionInfo('labeling')">
          <i class="fas fa-tag"></i>
          <span>Etiquetado</span>
        </div>
      </div>
      
      <div id="distortion-info" class="hidden technique-step">
        <h4 id="distortion-title"></h4>
        <p id="distortion-description"></p>
        <div id="distortion-example"></div>
        <div id="distortion-challenge"></div>
      </div>
    </div>
    
    <div class="technique-card">
      <div class="technique-header">
        <div class="technique-icon">
          <i class="fas fa-clipboard-check"></i>
        </div>
        <h3>Registro ABC de Emociones</h3>
      </div>
      <p>Analiza la conexión entre situaciones (A), creencias (B) y consecuencias emocionales (C) para entender mejor tus reacciones.</p>
      
      <div class="abc-record">
        <div class="thought-field">
          <label><strong>A - Activador (Situación):</strong></label>
          <textarea id="abc-activator" placeholder="Describe la situación específica que desencadenó tu malestar..." rows="2"></textarea>
        </div>
        <div class="thought-field">
          <label><strong>B - Belief (Creencia/Pensamiento):</strong></label>
          <textarea id="abc-belief" placeholder="¿Qué pensaste exactamente? ¿Qué interpretación hiciste?" rows="2"></textarea>
        </div>
        <div class="thought-field">
          <label><strong>C - Consecuencia (Emoción/Comportamiento):</strong></label>
          <textarea id="abc-consequence" placeholder="¿Cómo te sentiste? ¿Qué hiciste?" rows="2"></textarea>
        </div>
        <div class="thought-field">
          <label><strong>D - Disputa (Cuestionamiento):</strong></label>
          <textarea id="abc-dispute" placeholder="¿Qué evidencia tengo de este pensamiento? ¿Hay interpretaciones alternativas?" rows="2"></textarea>
        </div>
        <div class="thought-field">
          <label><strong>E - Efectivo nuevo (Nueva respuesta):</strong></label>
          <textarea id="abc-effective" placeholder="Reformula de manera más equilibrada y realista..." rows="2"></textarea>
        </div>
        <button onclick="saveABCRecord()" class="btn-primary">Guardar Análisis ABC</button>
      </div>
    </div>
    
    <div class="technique-card">
      <div class="technique-header">
        <div class="technique-icon">
          <i class="fas fa-chart-line"></i>
        </div>
        <h3>Seguimiento Conductual</h3>
      </div>
      <p>Registra tus actividades y estado de ánimo para identificar patrones y mejorar tu activación conductual.</p>
      
      <div class="behavior-tracking">
        <div class="tracking-input">
          <label>Actividad realizada:</label>
          <input type="text" id="activity-input" placeholder="Ej: Caminata de 20 minutos">
        </div>
        <div class="tracking-input">
          <label>Estado de ánimo antes (1-10):</label>
          <input type="range" id="mood-before" min="1" max="10" value="5">
          <span id="mood-before-value">5</span>
        </div>
        <div class="tracking-input">
          <label>Estado de ánimo después (1-10):</label>
          <input type="range" id="mood-after" min="1" max="10" value="5">
          <span id="mood-after-value">5</span>
        </div>
        <div class="tracking-input">
          <label>Nivel de satisfacción (1-10):</label>
          <input type="range" id="satisfaction-level" min="1" max="10" value="5">
          <span id="satisfaction-value">5</span>
        </div>
        <button onclick="saveBehaviorTracking()" class="btn-primary">Registrar Actividad</button>
      </div>
      
      <div id="behavior-log" class="behavior-log">
        <h4>Registro de Actividades</h4>
        <div id="behavior-entries"></div>
      </div>
    </div>
    
    <div class="technique-resources">
      <h3><i class="fas fa-books"></i> Recursos de TCC</h3>
      <a href="https://www.cognitivetherapyassociation.org/" target="_blank" class="resource-link">
        <i class="fas fa-external-link-alt"></i> Asociación Internacional de Terapia Cognitiva
      </a>
      <a href="https://www.beckinstitute.org/" target="_blank" class="resource-link">
        <i class="fas fa-graduation-cap"></i> Instituto Beck - Recursos TCC
      </a>
      <a href="https://www.apa.org/ptsd-guideline/patients-and-families/cognitive-behavioral" target="_blank" class="resource-link">
        <i class="fas fa-file-medical"></i> APA - Guía TCC
      </a>
    </div>
    
    <div class="nav-buttons">
      <button class="btn-secondary" onclick="nextStep('cbt-module-section','techniques-section')"><i class="fas fa-arrow-left"></i> Volver a Técnicas</button>
      <button onclick="nextStep('cbt-module-section','mindfulness-module-section')"><i class="fas fa-leaf"></i> Mindfulness</button>
    </div>
  </section>
  
  <!-- Módulo Mindfulness Avanzado -->
  <section id="mindfulness-module-section" class="hidden">
    <div class="section-header">
      <i class="fas fa-leaf"></i>
      <h1>Mindfulness y Atención Plena</h1>
      <p>Prácticas basadas en la reducción del estrés por mindfulness (MBSR) del Dr. Jon Kabat-Zinn</p>
    </div>
    
    <div class="technique-card">
      <div class="technique-header">
        <div class="technique-icon">
          <i class="fas fa-eye"></i>
        </div>
        <h3>Ejercicio de los Cinco Sentidos</h3>
      </div>
      <p>Una técnica de grounding que te conecta con el momento presente usando todos tus sentidos.</p>
      
      <div class="mindfulness-exercise">
        <button onclick="startFiveSensesExercise()" class="btn-primary">
          <i class="fas fa-play"></i> Comenzar Ejercicio Guiado
        </button>
        <div id="five-senses-guide" class="hidden">
          <div id="sense-instruction" class="technique-step"></div>
          <div class="meditation-timer" id="sense-timer">00:30</div>
          <button onclick="nextSenseStep()" id="next-sense-btn" class="btn-secondary">Siguiente</button>
        </div>
      </div>
    </div>
    
    <div class="technique-card">
      <div class="technique-header">
        <div class="technique-icon">
          <i class="fas fa-apple-alt"></i>
        </div>
        <h3>Alimentación Consciente</h3>
      </div>
      <p>Practica mindfulness mientras comes, desarrollando una relación más saludable con la comida.</p>
      
      <div class="mindful-eating-guide">
        <div class="technique-step">
          <h4>🍇 Paso 1: Observación Visual</h4>
          <p>Mirá tu comida como si la vieras por primera vez. Notá colores, texturas, formas.</p>
        </div>
        <div class="technique-step">
          <h4>👃 Paso 2: Aromas</h4>
          <p>Acercá la comida a tu nariz. ¿Qué aromas detectás? ¿Cómo responde tu cuerpo?</p>
        </div>
        <div class="technique-step">
          <h4>🤲 Paso 3: Tacto</h4>
          <p>Si es apropiado, tocá la comida. ¿Está suave, áspera, fría, tibia?</p>
        </div>
        <div class="technique-step">
          <h4>👅 Paso 4: Primer Bocado</h4>
          <p>Ponéla en tu boca sin masticar aún. ¿Qué sabores aparecen inmediatamente?</p>
        </div>
        <div class="technique-step">
          <h4>🦷 Paso 5: Masticación Consciente</h4>
          <p>Masticá lentamente, notando cómo cambian los sabores y texturas.</p>
        </div>
        <div class="technique-step">
          <h4>😌 Paso 6: Deglución Mindful</h4>
          <p>Tragá conscientemente, siguiendo la comida por tu garganta.</p>
        </div>
      </div>
    </div>
    
    <div class="technique-card">
      <div class="technique-header">
        <div class="technique-icon">
          <i class="fas fa-walking"></i>
        </div>
        <h3>Caminata Mindful</h3>
      </div>
      <p>Transforma una caminata ordinaria en una práctica de meditación activa.</p>
      
      <div class="walking-meditation">
        <div class="technique-step">
          <h4>🚶‍♀️ Preparación</h4>
          <p>Comenzá parado/a. Sentí tus pies en contacto con el suelo, tu postura, el aire en tu piel.</p>
        </div>
        <div class="technique-step">
          <h4>👣 Primer Paso</h4>
          <p>Levantá un pie lentamente, notando el cambio de peso, el movimiento de los músculos.</p>
        </div>
        <div class="technique-step">
          <h4>🌍 Caminata Consciente</h4>
          <p>Caminá más lento de lo normal. Con cada paso, notá: levantar, mover, apoyar.</p>
        </div>
        <div class="technique-step">
          <h4>🧠 Cuando la Mente Divague</h4>
          <p>Es normal que tu mente se distraiga. Suavemente volvé tu atención a tus pasos.</p>
        </div>
        <button onclick="startWalkingTimer()" class="btn-primary">
          <i class="fas fa-stopwatch"></i> Cronómetro para Caminata (10 min)
        </button>
        <div class="meditation-timer" id="walking-timer">10:00</div>
      </div>
    </div>
    
    <div class="technique-card">
      <div class="technique-header">
        <div class="technique-icon">
          <i class="fas fa-spa"></i>
        </div>
        <h3>Relajación Muscular Progresiva Mindful</h3>
      </div>
      <p>Combina mindfulness con relajación muscular profunda para liberar tensión física y mental.</p>
      
      <div class="progressive-relaxation">
        <button onclick="startProgressiveRelaxation()" class="btn-primary">
          <i class="fas fa-play"></i> Iniciar Relajación Guiada (15 min)
        </button>
        <div id="relaxation-guide" class="hidden">
          <div id="relaxation-instruction" class="technique-step"></div>
          <div class="meditation-timer" id="relaxation-timer">15:00</div>
          <div class="progress-bar">
            <div class="progress" id="relaxation-progress"></div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="technique-resources">
      <h3><i class="fas fa-books"></i> Recursos de Mindfulness</h3>
      <a href="https://www.mindfulnessmbsr.com/" target="_blank" class="resource-link">
        <i class="fas fa-graduation-cap"></i> MBSR - Programa de Jon Kabat-Zinn
      </a>
      <a href="https://www.mindful.org/" target="_blank" class="resource-link">
        <i class="fas fa-leaf"></i> Mindful.org - Recursos y Artículos
      </a>
      <a href="https://palousemindfulness.com/" target="_blank" class="resource-link">
        <i class="fas fa-laptop"></i> Curso MBSR Online Gratuito
      </a>
    </div>
    
    <div class="nav-buttons">
      <button class="btn-secondary" onclick="nextStep('mindfulness-module-section','cbt-module-section')"><i class="fas fa-arrow-left"></i> TCC</button>
      <button onclick="nextStep('mindfulness-module-section','act-module-section')"><i class="fas fa-compass"></i> ACT</button>
    </div>
  </section>
  
  <!-- Módulo ACT (Terapia de Aceptación y Compromiso) -->
  <section id="act-module-section" class="hidden">
    <div class="section-header">
      <i class="fas fa-compass"></i>
      <h1>Terapia de Aceptación y Compromiso (ACT)</h1>
      <p>Desarrolla flexibilidad psicológica y vive según tus valores más profundos</p>
    </div>
    
    <div class="technique-card">
      <div class="technique-header">
        <div class="technique-icon">
          <i class="fas fa-heart"></i>
        </div>
        <h3>Exploración de Valores</h3>
      </div>
      <p>Identifica qué es realmente importante para ti en diferentes áreas de tu vida.</p>
      
      <div class="values-exploration">
        <div class="values-grid">
          <div class="value-card" onclick="selectValue('family')">
            <i class="fas fa-home"></i>
            <h4>Familia</h4>
          </div>
          <div class="value-card" onclick="selectValue('health')">
            <i class="fas fa-heartbeat"></i>
            <h4>Salud</h4>
          </div>
          <div class="value-card" onclick="selectValue('growth')">
            <i class="fas fa-seedling"></i>
            <h4>Crecimiento</h4>
          </div>
          <div class="value-card" onclick="selectValue('creativity')">
            <i class="fas fa-palette"></i>
            <h4>Creatividad</h4>
          </div>
          <div class="value-card" onclick="selectValue('community')">
            <i class="fas fa-users"></i>
            <h4>Comunidad</h4>
          </div>
          <div class="value-card" onclick="selectValue('knowledge')">
            <i class="fas fa-book"></i>
            <h4>Conocimiento</h4>
          </div>
          <div class="value-card" onclick="selectValue('spirituality')">
            <i class="fas fa-om"></i>
            <h4>Espiritualidad</h4>
          </div>
          <div class="value-card" onclick="selectValue('adventure')">
            <i class="fas fa-mountain"></i>
            <h4>Aventura</h4>
          </div>
        </div>
        
        <div id="selected-values" class="technique-step hidden">
          <h4>Valores Seleccionados:</h4>
          <div id="values-list"></div>
          <textarea id="values-reflection" placeholder="Reflexiona: ¿Por qué estos valores son importantes para ti? ¿Cómo te sentís cuando vivís alineado/a con ellos?" rows="4"></textarea>
          <button onclick="saveValuesReflection()" class="btn-primary">Guardar Reflexión</button>
        </div>
      </div>
    </div>
    
    <div class="technique-card">
      <div class="technique-header">
        <div class="technique-icon">
          <i class="fas fa-cloud"></i>
        </div>
        <h3>Defusión Cognitiva</h3>
      </div>
      <p>Aprende a observar tus pensamientos sin quedar atrapado/a en ellos.</p>
      
      <div class="defusion-exercises">
        <div class="technique-step">
          <h4>🎭 Ejercicio: "Gracias, Mente"</h4>
          <p>Cuando tengas un pensamiento problemático, decí: "Gracias, mente, por ese pensamiento."</p>
          <button onclick="practiceThanksMind()" class="btn-secondary">Practicar</button>
        </div>
        
        <div class="technique-step">
          <h4>🎵 Ejercicio: Cantar el Pensamiento</h4>
          <p>Tomá tu pensamiento negativo y cantalo con la melodía de "Cumpleaños Feliz".</p>
          <input type="text" id="thought-to-sing" placeholder="Escribí un pensamiento problemático aquí...">
          <button onclick="singThought()" class="btn-secondary">Cantar Pensamiento</button>
        </div>
        
        <div class="technique-step">
          <h4>🏷️ Ejercicio: "Estoy Teniendo el Pensamiento..."</h4>
          <p>Reformula tus pensamientos: En lugar de "Soy un fracaso", decí "Estoy teniendo el pensamiento de que soy un fracaso".</p>
          <input type="text" id="original-thought" placeholder="Pensamiento original...">
          <button onclick="reformulateThought()" class="btn-secondary">Reformular</button>
          <div id="reformulated-thought" class="technique-step hidden"></div>
        </div>
      </div>
    </div>
    
    <div class="technique-card">
      <div class="technique-header">
        <div class="technique-icon">
          <i class="fas fa-target"></i>
        </div>
        <h3>Acciones Comprometidas</h3>
      </div>
      <p>Planifica acciones concretas alineadas con tus valores, independientemente de cómo te sientas.</p>
      
      <div class="committed-actions">
        <div class="thought-field">
          <label><strong>Valor elegido:</strong></label>
          <select id="chosen-value">
            <option value="">Selecciona un valor...</option>
            <option value="family">Familia</option>
            <option value="health">Salud</option>
            <option value="growth">Crecimiento Personal</option>
            <option value="creativity">Creatividad</option>
            <option value="community">Comunidad</option>
            <option value="knowledge">Conocimiento</option>
            <option value="spirituality">Espiritualidad</option>
            <option value="adventure">Aventura</option>
          </select>
        </div>
        
        <div class="thought-field">
          <label><strong>Acción específica (pequeña y concreta):</strong></label>
          <textarea id="specific-action" placeholder="Ej: Llamar a mi hermana por 10 minutos, caminar 15 minutos, leer un capítulo..." rows="2"></textarea>
        </div>
        
        <div class="thought-field">
          <label><strong>¿Cuándo lo vas a hacer?</strong></label>
          <input type="datetime-local" id="action-when">
        </div>
        
        <div class="thought-field">
          <label><strong>Obstáculos emocionales esperados:</strong></label>
          <textarea id="emotional-obstacles" placeholder="Ej: Podría sentir pereza, ansiedad, tristeza..." rows="2"></textarea>
        </div>
        
        <div class="thought-field">
          <label><strong>Compromiso (del 1 al 10):</strong></label>
          <input type="range" id="commitment-level" min="1" max="10" value="8">
          <span id="commitment-value">8</span>
        </div>
        
        <button onclick="saveCommittedAction()" class="btn-primary">Crear Compromiso</button>
        
        <div id="committed-actions-list" class="behavior-log">
          <h4>Mis Compromisos</h4>
          <div id="actions-entries"></div>
        </div>
      </div>
    </div>
    
    <div class="technique-card">
      <div class="technique-header">
        <div class="technique-icon">
          <i class="fas fa-scale-balanced"></i>
        </div>
        <h3>Flexibilidad Psicológica</h3>
      </div>
      <p>Evalúa tu capacidad de adaptarte a las circunstancias y actuar según tus valores.</p>
      
      <div class="flexibility-assessment">
        <div class="technique-step">
          <h4>📊 Auto-Evaluación de Flexibilidad</h4>
          <p>Responde en una escala del 1 (nunca) al 5 (siempre):</p>
        </div>
        
        <div class="assessment-questions">
          <div class="question-item">
            <p>1. Puedo continuar trabajando hacia mis metas incluso cuando me siento mal emocionalmente.</p>
            <input type="range" id="q1" min="1" max="5" value="3" onchange="updateFlexibilityScore()">
            <span id="q1-value">3</span>
          </div>
          <div class="question-item">
            <p>2. Acepto mis pensamientos y sentimientos negativos sin intentar cambiarlos inmediatamente.</p>
            <input type="range" id="q2" min="1" max="5" value="3" onchange="updateFlexibilityScore()">
            <span id="q2-value">3</span>
          </div>
          <div class="question-item">
            <p>3. Me mantengo presente y consciente en lugar de quedar atrapado/a en preocupaciones.</p>
            <input type="range" id="q3" min="1" max="5" value="3" onchange="updateFlexibilityScore()">
            <span id="q3-value">3</span>
          </div>
          <div class="question-item">
            <p>4. Mis valores guían mis acciones más que mis emociones del momento.</p>
            <input type="range" id="q4" min="1" max="5" value="3" onchange="updateFlexibilityScore()">
            <span id="q4-value">3</span>
          </div>
          <div class="question-item">
            <p>5. Veo mis pensamientos como eventos mentales, no como verdades absolutas.</p>
            <input type="range" id="q5" min="1" max="5" value="3" onchange="updateFlexibilityScore()">
            <span id="q5-value">3</span>
          </div>
        </div>
        
        <div class="flexibility-result">
          <h4>Tu Puntuación de Flexibilidad: <span id="flexibility-score">15</span>/25</h4>
          <div id="flexibility-feedback" class="technique-step"></div>
        </div>
      </div>
    </div>
    
    <div class="technique-resources">
      <h3><i class="fas fa-books"></i> Recursos de ACT</h3>
      <a href="https://www.actmindfully.com.au/" target="_blank" class="resource-link">
        <i class="fas fa-compass"></i> ACT Mindfully - Recursos y Ejercicios
      </a>
      <a href="https://contextualscience.org/" target="_blank" class="resource-link">
        <i class="fas fa-university"></i> Association for Contextual Behavioral Science
      </a>
      <a href="https://stevenchayes.com/" target="_blank" class="resource-link">
        <i class="fas fa-user-graduate"></i> Steven Hayes - Creador de ACT
      </a>
    </div>
    
    <div class="nav-buttons">
      <button class="btn-secondary" onclick="nextStep('act-module-section','mindfulness-module-section')"><i class="fas fa-arrow-left"></i> Mindfulness</button>
      <button onclick="nextStep('act-module-section','music-therapy-section')"><i class="fas fa-music"></i> Musicoterapia</button>
    </div>
  </section>
  
  <!-- Módulo Musicoterapia -->
  <section id="music-therapy-section" class="hidden">
    <div class="section-header">
      <i class="fas fa-music"></i>
      <h1>Musicoterapia Terapéutica</h1>
      <p>Utiliza el poder curativo de la música y el sonido para el bienestar emocional</p>
    </div>
    
    <div class="technique-card">
      <div class="technique-header">
        <div class="technique-icon">
          <i class="fas fa-headphones"></i>
        </div>
        <h3>Frecuencias Terapéuticas</h3>
      </div>
      <p>Diferentes frecuencias de sonido pueden influir en tu estado emocional y mental.</p>
      
      <div class="music-library">
        <div class="music-card">
          <div class="music-header">
            <div class="music-icon">
              <i class="fas fa-spa"></i>
            </div>
            <h4>528 Hz - Frecuencia del Amor</h4>
          </div>
          <p>Conocida como la "frecuencia de la transformación". Ayuda a reparar el ADN y promueve sentimientos de amor y paz.</p>
          <div class="frequency-display">528 Hz</div>
          <div class="music-controls">
            <button class="audio-control-btn" onclick="playFrequency('528')">
              <i class="fas fa-play" id="freq-528-icon"></i>
            </button>
            <button class="audio-control-btn" onclick="stopFrequency('528')">
              <i class="fas fa-stop"></i>
            </button>
          </div>
        </div>
        
        <div class="music-card">
          <div class="music-header">
            <div class="music-icon">
              <i class="fas fa-brain"></i>
            </div>
            <h4>432 Hz - Frecuencia Natural</h4>
          </div>
          <p>Sintonizada con la naturaleza. Reduce la ansiedad y promueve la relajación profunda y la claridad mental.</p>
          <div class="frequency-display">432 Hz</div>
          <div class="music-controls">
            <button class="audio-control-btn" onclick="playFrequency('432')">
              <i class="fas fa-play" id="freq-432-icon"></i>
            </button>
            <button class="audio-control-btn" onclick="stopFrequency('432')">
              <i class="fas fa-stop"></i>
            </button>
          </div>
        </div>
        
        <div class="music-card">
          <div class="music-header">
            <div class="music-icon">
              <i class="fas fa-moon"></i>
            </div>
            <h4>40 Hz - Ondas Gamma</h4>
          </div>
          <p>Estimula las ondas cerebrales gamma, mejorando la concentración, memoria y estados de flujo consciente.</p>
          <div class="frequency-display">40 Hz</div>
          <div class="music-controls">
            <button class="audio-control-btn" onclick="playFrequency('40')">
              <i class="fas fa-play" id="freq-40-icon"></i>
            </button>
            <button class="audio-control-btn" onclick="stopFrequency('40')">
              <i class="fas fa-stop"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
    
    <div class="technique-card">
      <div class="technique-header">
        <div class="technique-icon">
          <i class="fas fa-drum"></i>
        </div>
        <h3>Ritmo y Respiración</h3>
      </div>
      <p>Sincroniza tu respiración con ritmos específicos para regular tu sistema nervioso.</p>
      
      <div class="rhythm-breathing">
        <div class="technique-step">
          <h4>🥁 Ejercicio de Tambor Cardíaco</h4>
          <p>Usa el ritmo para estabilizar tu frecuencia cardíaca y calmar tu mente.</p>
          <button onclick="startHeartDrumming()" class="btn-primary">
            <i class="fas fa-play"></i> Iniciar Tambor Cardíaco
          </button>
          <div id="heart-drum-guide" class="hidden">
            <div class="circle" id="heart-drum-circle">♥</div>
            <p id="drum-instruction">Respirá siguiendo el pulso del corazón</p>
            <div class="meditation-timer" id="drum-timer">05:00</div>
          </div>
        </div>
        
        <div class="technique-step">
          <h4>🎵 Respiración con Metrónomo</h4>
          <p>Sincroniza tu respiración con un metrónomo para crear coherencia cardíaca.</p>
          <div class="metronome-controls">
            <label>BPM (respiraciones por minuto):</label>
            <input type="range" id="bpm-slider" min="6" max="12" value="8">
            <span id="bpm-value">8</span>
            <button onclick="startMetronomeBreathing()" class="btn-primary">
              <i class="fas fa-play"></i> Iniciar Metrónomo
            </button>
          </div>
          <div id="metronome-guide" class="hidden">
            <div class="circle" id="metronome-circle">Inhalar</div>
            <div class="meditation-timer" id="metronome-timer">05:00</div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="technique-card">
      <div class="technique-header">
        <div class="technique-icon">
          <i class="fas fa-microphone"></i>
        </div>
        <h3>Vocalización Terapéutica</h3>
      </div>
      <p>Utiliza tu propia voz como herramienta de sanación y liberación emocional.</p>
      
      <div class="vocalization-exercises">
        <div class="technique-step">
          <h4>🎤 Mantras Curativos</h4>
          <p>Repite estos mantras en voz alta o mental para diferentes propósitos:</p>
          <div class="mantras-list">
            <div class="mantra-item" onclick="playMantra('om')">
              <strong>OM</strong> - Para centrarse y conectar con el universo
            </div>
            <div class="mantra-item" onclick="playMantra('soham')">
              <strong>SO HAM</strong> - "Yo soy eso" - Para la autoconciencia
            </div>
            <div class="mantra-item" onclick="playMantra('peace')">
              <strong>Que haya paz</strong> - Para calmar conflictos internos
            </div>
            <div class="mantra-item" onclick="playMantra('love')">
              <strong>Que todos los seres sean felices</strong> - Para generar compasión
            </div>
          </div>
        </div>
        
        <div class="technique-step">
          <h4>🌬️ Tonificación con Vocales</h4>
          <p>Cada vocal resuena en diferentes partes del cuerpo:</p>
          <div class="vowel-toning">
            <button onclick="toneVowel('A')" class="btn-secondary">A (Corazón)</button>
            <button onclick="toneVowel('E')" class="btn-secondary">E (Garganta)</button>
            <button onclick="toneVowel('I')" class="btn-secondary">I (Cabeza)</button>
            <button onclick="toneVowel('O')" class="btn-secondary">O (Pecho)</button>
            <button onclick="toneVowel('U')" class="btn-secondary">U (Abdomen)</button>
          </div>
          <div id="vowel-instruction" class="technique-step hidden"></div>
        </div>
      </div>
    </div>
    
    <div class="technique-card">
      <div class="technique-header">
        <div class="technique-icon">
          <i class="fas fa-music-note"></i>
        </div>
        <h3>Música Receptiva</h3>
      </div>
      <p>Escucha música seleccionada específicamente para diferentes estados emocionales.</p>
      
      <div class="receptive-music">
        <div class="music-mood-selector">
          <h4>Selecciona tu estado emocional actual:</h4>
          <div class="mood-music-grid">
            <button onclick="selectMusicMood('anxiety')" class="mood-music-btn">
              <i class="fas fa-wind"></i> Ansiedad
            </button>
            <button onclick="selectMusicMood('sadness')" class="mood-music-btn">
              <i class="fas fa-cloud-rain"></i> Tristeza
            </button>
            <button onclick="selectMusicMood('anger')" class="mood-music-btn">
              <i class="fas fa-fire"></i> Ira
            </button>
            <button onclick="selectMusicMood('stress')" class="mood-music-btn">
              <i class="fas fa-bolt"></i> Estrés
            </button>
            <button onclick="selectMusicMood('grief')" class="mood-music-btn">
              <i class="fas fa-heart-broken"></i> Duelo
            </button>
            <button onclick="selectMusicMood('peace')" class="mood-music-btn">
              <i class="fas fa-dove"></i> Busco Paz
            </button>
          </div>
        </div>
        
        <div id="music-recommendation" class="technique-step hidden">
          <h4 id="music-mood-title"></h4>
          <p id="music-description"></p>
          <div id="music-playlist"></div>
        </div>
      </div>
    </div>
    
    <div class="technique-resources">
      <h3><i class="fas fa-books"></i> Recursos de Musicoterapia</h3>
      <a href="https://www.musictherapy.org/" target="_blank" class="resource-link">
        <i class="fas fa-music"></i> American Music Therapy Association
      </a>
      <a href="https://www.musictherapyworld.net/" target="_blank" class="resource-link">
        <i class="fas fa-globe"></i> World Federation of Music Therapy
      </a>
      <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3734071/" target="_blank" class="resource-link">
        <i class="fas fa-file-medical"></i> Investigación Científica en Musicoterapia
      </a>
    </div>
    
    <div class="nav-buttons">
      <button class="btn-secondary" onclick="nextStep('music-therapy-section','act-module-section')"><i class="fas fa-arrow-left"></i> ACT</button>
      <button onclick="nextStep('music-therapy-section','techniques-section')"><i class="fas fa-heart"></i> Volver a Técnicas</button>
    </div>
  </section>
  
  <div class="footer">© 2025 Serenamente – Apoyo Emocional Basado en Evidencia – No reemplaza atención profesional.</div>
</div>
<script>
  // Variables globales
  let currentCrisis = "";
  let currentTechniqueIndex = 0;
  let userName = "";
  let breathingInterval;
  let bodyScanInterval;
  let mindfulnessInterval;
  let moodHistory = [];
  let habits = {
    exercise: 0,
    meditation: 0,
    nature: 0,
    gratitude: 0
  };
  let goals = [];
  let audioPlayers = {};
  
  // Inicializar reproductores de audio
  function initAudioPlayers() {
    // Sonidos de agua
    audioPlayers.water = {
      audio: new Audio('C:\Users\dsd22\serenamente-app\audioterapia'),
      isPlaying: false,
      duration: 3600 // 60 minutos en segundos
    };
    
    // Sonidos de naturaleza
    audioPlayers.nature = {
      audio: new Audio('https://cdn.pixabay.com/download/audio/2022/01/20/audio_b226d58548.mp3'),
      isPlaying: false,
      duration: 3600 // 60 minutos en segundos
    };
    
    // Música binaural
    audioPlayers.binaural = {
      audio: new Audio('https://cdn.pixabay.com/download/audio/2022/03/10/audio_7a7b0c3f9c.mp3'),
      isPlaying: false,
      duration: 1800 // 30 minutos en segundos
    };
    
    // Sonidos para dormir
    audioPlayers.sleep = {
      audio: new Audio('https://cdn.pixabay.com/download/audio/2022/03/10/audio_371cc01150.mp3'),
      isPlaying: false,
      duration: 7200 // 120 minutos en segundos
    };
    
    // Tibetan Singing Bowls
    audioPlayers.tibetan = {
      audio: new Audio('https://cdn.pixabay.com/download/audio/2022/03/10/audio_371cc01150.mp3'),
      isPlaying: false,
      duration: 2700 // 45 minutos en segundos
    };
    
    // Configurar eventos para todos los reproductores
    Object.keys(audioPlayers).forEach(key => {
      const player = audioPlayers[key];
      
      // Configurar volumen inicial
      const volumeSlider = document.getElementById(`${key}-volume`);
      if (volumeSlider) {
        player.audio.volume = parseFloat(volumeSlider.value);
        
        volumeSlider.addEventListener('input', function() {
          player.audio.volume = parseFloat(this.value);
        });
      }
      
      // Evento cuando termina el audio
      player.audio.addEventListener('ended', function() {
        stopAudio(key);
      });
      
      // Evento para actualizar la duración
      player.audio.addEventListener('timeupdate', function() {
        updateAudioDuration(key);
      });
    });
  }
  
  // Función para reproducir/pausar audio
  function toggleAudio(audioType) {
    const player = audioPlayers[audioType];
    const playIcon = document.getElementById(`${audioType}-play-icon`);
    
    if (player.isPlaying) {
      player.audio.pause();
      playIcon.classList.remove('fa-pause');
      playIcon.classList.add('fa-play');
      player.isPlaying = false;
    } else {
      // Pausar otros audios
      Object.keys(audioPlayers).forEach(key => {
        if (key !== audioType && audioPlayers[key].isPlaying) {
          audioPlayers[key].audio.pause();
          document.getElementById(`${key}-play-icon`).classList.remove('fa-pause');
          document.getElementById(`${key}-play-icon`).classList.add('fa-play');
          audioPlayers[key].isPlaying = false;
        }
      });
      
      player.audio.play();
      playIcon.classList.remove('fa-play');
      playIcon.classList.add('fa-pause');
      player.isPlaying = true;
    }
  }
  
  // Función para detener audio
  function stopAudio(audioType) {
    const player = audioPlayers[audioType];
    const playIcon = document.getElementById(`${audioType}-play-icon`);
    
    player.audio.pause();
    player.audio.currentTime = 0;
    playIcon.classList.remove('fa-pause');
    playIcon.classList.add('fa-play');
    player.isPlaying = false;
    updateAudioDuration(audioType);
  }
  
  // Función para actualizar la duración del audio
  function updateAudioDuration(audioType) {
    const player = audioPlayers[audioType];
    const durationElement = document.getElementById(`${audioType}-duration`);
    
    if (durationElement && player.audio) {
      const currentMinutes = Math.floor(player.audio.currentTime / 60);
      const currentSeconds = Math.floor(player.audio.currentTime % 60);
      const totalMinutes = Math.floor(player.duration / 60);
      const totalSeconds = Math.floor(player.duration % 60);
      
      durationElement.textContent = `${currentMinutes.toString().padStart(2, '0')}:${currentSeconds.toString().padStart(2, '0')} / ${totalMinutes.toString().padStart(2, '0')}:${totalSeconds.toString().padStart(2, '0')}`;
    }
  }
  
  // Cargar datos desde localStorage al iniciar
  document.addEventListener('DOMContentLoaded', function() {
    // Inicializar reproductores de audio
    initAudioPlayers();
    
    // Cargar datos guardados
    loadFromStorage();
    
    // Inicializar contadores
    updateProgressStats();
    
    // Generar gráfico de ánimo
    generateMoodChart();
    
    // Configurar modo oscuro
    const darkModeToggle = document.getElementById('darkModeToggle');
    darkModeToggle.addEventListener('change', function(){
      document.body.classList.toggle('dark-mode');
    });
    
    // Configurar consentimiento
    document.getElementById('consentCheck').addEventListener('change', function(){
      document.getElementById('consentBtn').disabled = !this.checked;
    });
    
    // Configurar selección de estado de ánimo
    document.querySelectorAll('.mood').forEach(el => {
      el.addEventListener('click', function() {
        document.querySelectorAll('.mood').forEach(m => m.classList.remove('selected'));
        this.classList.add('selected');
        const crisis = this.dataset.value;
        currentCrisis = crisis;
        setTheme(crisis);
        
        // Guardar en historial de ánimo
        moodHistory.push({
          mood: crisis,
          date: new Date().toISOString()
        });
        saveToStorage();
        analyzeRiskLevel();
        
        if(crisis === 'suicida') {
          nextStep('mood-section','crisis-section');
        } else {
          nextStep('mood-section','techniques-section');
          showCrisisTechniques(crisis);
        }
      });
    });
  });
  
  // Funciones de navegación
  function nextStep(current, next) {
    document.getElementById(current).classList.add('hidden');
    document.getElementById(next).classList.remove('hidden');
    window.scrollTo(0, 0);
  }
  
  // Cambiar tema según estado de ánimo
  function setTheme(theme) {
    // Remover todos los temas actuales
    document.body.className = document.body.className.replace(/theme-\w+/g, '').trim();
    // Añadir el nuevo tema
    document.body.classList.add(`theme-${theme}`);
  }
  
  // Guardar nombre y malestar
  function saveName() {
    const name = document.getElementById('userName').value.trim();
    if(name) {
      userName = name;
      document.getElementById('displayName').textContent = name;
      nextStep('name-section','mood-section');
      // Guardar fecha de primer uso
      if (!localStorage.getItem('firstEntryDate')) {
        localStorage.setItem('firstEntryDate', new Date().toISOString());
      }
      saveToStorage();
    } else {
      alert('Por favor, ingresá tu nombre para continuar.');
    }
  }
  
  // Técnicas profesionales mejoradas basadas en investigación
  const crisisTechniques = {
    "duelo": [
      {
        title: "Ejercicio de Letter Writing (Universidad de Texas)", 
        text: "Escribir una carta a la persona o situación perdida puede ayudar a procesar emociones. Investigación de la Universidad de Texas muestra que esta técnica facilita la elaboración del duelo.",
        icon: "fas fa-envelope",
        steps: [
          "Tomate 15-20 minutos sin interrupciones",
          "Escribí una carta expresando tus sentimientos: lo que extrañás, lo que lamentás, lo que agradecés",
          "No es necesario enviarla, el beneficio está en el proceso de expresión",
          "Podés guardarla, romperla o quemarla simbólicamente según te haga sentir mejor"
        ],
        duration: "15-20 minutos",
        research: "Basado en investigación de la Universidad de Texas sobre procesamiento emocional"
      },
      {
        title: "Técnica de Silla Vacía (Gestalt Therapy)", 
        text: "Esta técnica de la terapia Gestalt ayuda a dialogar con la persona perdida para cerrar asuntos pendientes y expresar emociones no dichas.",
        icon: "fas fa-chair",
        steps: [
          "Colocá una silla vacía frente a vos",
          "Imaginá que la persona está sentada allí",
          "Decile todo lo que necesites expresar: lo que no tuviste chance de decir, tus sentimientos",
          "Ahora sentate en la silla y respondé como si fueras esa persona",
          "Alterná entre sillas según lo necesites"
        ],
        duration: "20-30 minutos",
        research: "Técnica validada de la Terapia Gestalt"
      },
      {
        title: "Práctica de Autocompasión (Dr. Kristin Neff - Universidad de Texas)", 
        text: "Investigación muestra que la autocompasión es fundamental para procesar el duelo de manera saludable.",
        icon: "fas fa-hands-heart",
        steps: [
          "Reconocé tu dolor: 'Estoy pasando por un momento muy difícil'",
          "Recordá que el duelo es una experiencia humana universal",
          "Ofrecete palabras de bondad: 'Que me sea fácil transitar este dolor'",
          "Colocá las manos sobre el corazón y sentí el calor reconfortante",
          "Repetí frases compasivas: 'Merezco cuidado y comprensión en este momento'"
        ],
        duration: "10-15 minutos",
        research: "Basado en investigación de la Dra. Kristin Neff, Universidad de Texas"
      },
      {
        title: "Ritual de Despedida (Terapia Narrativa)", 
        text: "Crear un ritual simbólico para honrar la pérdida puede facilitar el proceso de duelo y proporcionar cierre emocional.",
        icon: "fas fa-candle-holder",
        steps: [
          "Elige un objeto simbólico que represente tu relación con lo perdido",
          "Crea un espacio sagrado en tu hogar para realizar el ritual",
          "Escribe una carta o poema expresando tus sentimientos",
          "Lee en voz alta tu carta/poema",
          "Realiza una acción simbólica (encender una vela, soltar un globo, plantar una flor)",
          "Guarda el objeto simbólico en un lugar especial o libéralo simbólicamente"
        ],
        duration: "30-45 minutos",
        research: "Basado en Terapia Narrativa y estudios sobre rituales en el duelo"
      }
    ],
    "ansiedad": [
      {
        title: "Respiración 4-7-8 (Dr. Andrew Weil - Harvard)", 
        text: "Técnica de respiración profunda que activa el sistema nervioso parasimpático y reduce la ansiedad en minutos. Validada por investigaciones de Harvard.",
        icon: "fas fa-lungs",
        steps: [
          "Inhalá por la nariz durante 4 segundos",
          "Mantené la respiración durante 7 segundos",
          "Exhalá lentamente por la boca durante 8 segundos",
          "Repetí este ciclo 4 veces",
          "Practicá esta técnica dos veces al día para mejores resultados"
        ],
        duration: "5 minutos",
        research: "Técnica popularizada por el Dr. Andrew Weil de Harvard"
      },
      {
        title: "Técnica 5-4-3-2-1 (Terapia Cognitivo-Conductual)", 
        text: "Ejercicio de grounding que te ayuda a conectar con el presente usando tus sentidos, alejando pensamientos ansiosos. Efectiva según múltiples estudios.",
        icon: "fas fa-mountain",
        steps: [
          "Identificá 5 cosas que podés VER a tu alrededor",
          "Identificá 4 cosas que podés TOCAR (texturas, temperaturas)",
          "Identificá 3 cosas que podés OÍR (sonidos cercanos y lejanos)",
          "Identificá 2 cosas que podés OLER",
          "Identificá 1 cosa que podés SABOREAR",
          "Repetí si es necesario hasta sentir mayor conexión con el presente"
        ],
        duration: "3-5 minutos",
        research: "Técnica de grounding validada en terapia cognitivo-conductual"
      },
      {
        title: "Exposición Gradual (TCC - Universidad de Boston)", 
        text: "Enfrentar gradualmente las situaciones que generan ansiedad ayuda a reducirla significativamente según investigaciones.",
        icon: "fas fa-chart-line",
        steps: [
          "Creá una lista de situaciones que te generan ansiedad, del 1 (menos ansiedad) al 10 (máxima ansiedad)",
          "Empezá por la situación que genere ansiedad nivel 2-3",
          "Exponete a esta situación hasta que tu ansiedad disminuya a la mitad",
          "Celebrá tus logros y pasá al siguiente nivel",
          "Practicá regularmente para consolidar los avances"
        ],
        duration: "Variable",
        research: "Técnica de exposición validada en la TCC (Universidad de Boston)"
      },
      {
        title: "Desensibilización Sistemática (Wolpe)", 
        text: "Combinar relajación profunda con visualización gradual de situaciones ansiosas para reducir la respuesta de ansiedad.",
        icon: "fas fa-brain",
        steps: [
          "Aprendé una técnica de relajación profunda (respiración diafragmática o relajación muscular progresiva)",
          "Creá una jerarquía de miedos (lista de situaciones ansiosas de menor a mayor intensidad)",
          "Mientras estás completamente relajado, visualizá la situación menos ansiosa de tu lista",
          "Mantené la visualización hasta que puedas hacerlo sin ansiedad",
          "Pasá a la siguiente situación en tu jerarquía",
          "Continuá hasta dominar todas las situaciones en tu lista"
        ],
        duration: "20-30 minutos por sesión",
        research: "Técnica desarrollada por Joseph Wolpe, ampliamente validada"
      },
      {
        title: "Técnica de la Hoja de Trabajo de Ansiedad (Terapia de Aceptación y Compromiso)", 
        text: "Ejercicio para externalizar y desidentificarte de tus pensamientos ansiosos, reduciendo su poder sobre ti.",
        icon: "fas fa-file-alt",
        steps: [
          "Identificá tu pensamiento ansioso más fuerte en este momento",
          "Escribilo en una hoja de papel",
          "Dibujá una caja alrededor del pensamiento",
          "Etiquetalo: 'Esto es solo un pensamiento, no un hecho'",
          "Preguntate: '¿Este pensamiento me está ayudando a vivir según mis valores?'",
          "Si no, decidí conscientemente dejarlo de lado y enfocarte en algo que sí te acerque a tus valores"
        ],
        duration: "10-15 minutos",
        research: "Basado en Terapia de Aceptación y Compromiso (ACT)"
      }
    ],
    "suicida": [
      {
        title: "Plan de Seguridad (DBT - Universidad de Washington)", 
        text: "Crear un plan por escrito con estrategias concretas para momentos de crisis puede salvar vidas. Desarrollado por la Dra. Marsha Linehan.",
        icon: "fas fa-shield-alt",
        steps: [
          "Identificá señales de alerta temprana (pensamientos, emociones, comportamientos)",
          "Listá estrategias de distracción (música, ejercicio, llamar a alguien)",
          "Anotá contactos de apoyo (amigos, familia, profesionales) con sus teléfonos",
          "Incluí números de líneas de crisis y servicios de emergencia",
          "Listá razones para vivir (cosas importantes, personas, metas)",
          "Asegurate de tener el plan accesible en todo momento"
        ],
        duration: "20-30 minutos",
        research: "Basado en Terapia Dialéctica Conductual (DBT) - Universidad de Washington"
      },
      {
        title: "Conectarse con el Presente (DBT - Mindfulness)", 
        text: "Técnicas para anclarse en el momento presente cuando los pensamientos abrumadores aparecen.",
        icon: "fas fa-anchor",
        steps: [
          "Enfocá tu atención en tu respiración por un minuto",
          "Describí 3 objetos a tu alrededor en detalle (color, forma, textura)",
          "Prendé una vela y concentrate en la llama",
          "Sosté un cubo de hielo y concentrate en la sensación de frío",
          "Repetí un mantra: 'Esto pasará', 'Soy más que mis pensamientos'"
        ],
        duration: "5-10 minutos",
        research: "Técnicas de distress tolerance de DBT - Universidad de Washington"
      },
      {
        title: "Técnica de la Caja de Herramientas de Supervivencia", 
        text: "Crear una caja física con objetos que te recuerden tus razones para vivir y te proporcionen consuelo en momentos de crisis.",
        icon: "fas fa-box",
        steps: [
          "Consiguí una caja decorativa o una caja de zapatos",
          "Llenala con objetos que representen tus razones para vivir: fotos de seres queridos, cartas, recuerdos especiales",
          "Incluí objetos sensoriales que te calmen: una manta suave, aceites esenciales, música relajante",
          "Agregá notas de aliento escritas por vos mismo/a en momentos de mayor fortaleza",
          "Guardá tu plan de seguridad en la caja",
          "Cuando sientas impulsos suicidas, abrí la caja y utilizá sus contenidos"
        ],
        duration: "30-60 minutos para crear, luego usar según necesidad",
        research: "Adaptado de técnicas de DBT y terapia centrada en soluciones"
      },
      {
        title: "Carta a Mi Yo Futuro", 
        text: "Escribir una carta a tu yo futuro describiendo cómo superaste esta crisis puede proporcionar esperanza y perspectiva.",
        icon: "fas fa-envelope-open-text",
        steps: [
          "Imaginá que estás 6 meses en el futuro, habiendo superado esta crisis",
          "Escribí una carta a tu yo actual desde esa perspectiva futura",
          "Describí cómo superaste los desafíos actuales",
          "Mencioná las lecciones aprendidas y la fuerza que descubriste en ti mismo/a",
          "Hablá de las cosas buenas que están por venir",
          "Guardá la carta y léela cuando necesites recordar que hay esperanza"
        ],
        duration: "20-30 minutos",
        research: "Técnica basada en terapia narrativa y terapia centrada en soluciones"
      }
    ],
    "trauma": [
      {
        title: "Técnica de Grounding (Universidad de Harvard)", 
        text: "Ejercicios para reconectar con el presente cuando surgen flashbacks o disociación relacionados con trauma.",
        icon: "fas fa-leaf",
        steps: [
          "Apretá tus pies contra el piso y sentí la conexión con la tierra",
          "Salpicá agua fría en tu rostro o tomá una bebida fría/caliente",
          "Tocá diferentes texturas a tu alrededor (suave, áspero, frío, caliente)",
          "Nombrá objetos que ves en la habitación (5 azules, 5 redondos)",
          "Usá aromas fuertes (café, menta, limón) para reconectar con el presente"
        ],
        duration: "5-10 minutos",
        research: "Técnicas de grounding validadas para trauma (Universidad de Harvard)"
      },
      {
        title: "Respiración Segura (Trauma-Informed Yoga)", 
        text: "Patrones de respiración que ayudan a regular el sistema nervioso después de experiencias traumáticas.",
        icon: "fas fa-wind",
        steps: [
          "Acostate boca arriba con las manos sobre el abdomen",
          "Inhalá profundamente por la nariz durante 4 segundos, sintiendo cómo se expande tu abdomen",
          "Exhalá lentamente por la boca durante 6 segundos, sintiendo cómo se contrae tu abdomen",
          "Repetí durante 5-10 minutos",
          "Imaginá que con cada exhalación liberás tensión y con cada inhalación recibís calma"
        ],
        duration: "5-10 minutos",
        research: "Basado en trauma-informed yoga y prácticas somáticas"
      },
      {
        title: "Ventana de Tolerancia (Terapia Sensoriomotora)", 
        text: "Aprender a identificar tu 'ventana de tolerancia' emocional y técnicas para regresar a ella cuando estés hiperactivado o hipoactivado.",
        icon: "fas fa-window-restore",
        steps: [
          "Dibujá una ventana en una hoja de papel",
          "En el centro, escribí 'Zona de Tolerancia' (donde te sentís regulado/a)",
          "Arriba de la ventana, escribí 'Hiperactivación' (ansiedad, pánico, ira)",
          "Debajo de la ventana, escribí 'Hipoactivación' (entumecimiento, desconexión, fatiga)",
          "Identificá tus señales personales de hiperactivación e hipoactivación",
          "Para hiperactivación: usa técnicas de grounding, respiración profunda, movimiento físico",
          "Para hipoactivación: usa estimulación sensorial (aromas fuertes, música energética, movimiento)",
          "Practicá regularmente para reconocer y regular tu estado"
        ],
        duration: "15-20 minutos",
        research: "Basado en Terapia Sensoriomotora y Neurobiología del Trauma (Dr. Dan Siegel)"
      },
      {
        title: "Narrativa Traumática Gradual (Terapia de Procesamiento de Trauma)", 
        text: "Contar tu historia traumática de manera gradual y controlada para procesarla y reducir su impacto emocional.",
        icon: "fas fa-book",
        steps: [
          "Elegí un entorno seguro y sin interrupciones",
          "Empezá contando solo los hechos básicos del evento traumático",
          "En sesiones posteriores, añadí más detalles emocionales y sensoriales",
          "Permitite sentir las emociones que surgen, pero detenete si te sientes abrumado/a",
          "Usá técnicas de grounding para volver al presente si es necesario",
          "Terminá cada sesión con una actividad placentera o calmante",
          "Considerá hacer esto con un terapeuta si el trauma es severo"
        ],
        duration: "20-30 minutos por sesión",
        research: "Adaptado de Terapia de Procesamiento de Trauma y EMDR"
      }
    ],
    "desesperanza": [
      {
        title: "Reestructuración Cognitiva (TCC - Universidad de Pennsylvania)", 
        text: "Técnica de terapia cognitiva para identificar y desafiar pensamientos negativos automáticos que alimentan la desesperanza. Desarrollada por el Dr. Aaron Beck.",
        icon: "fas fa-sync-alt",
        steps: [
          "Identificá el pensamiento negativo (Ej: 'Nada mejorará nunca')",
          "Cuestioná su veracidad: ¿Qué evidencia tengo a favor y en contra?",
          "Buscá interpretaciones alternativas más equilibradas",
          "Preguntate: '¿Qué le diría a un amigo que tuviera este pensamiento?'",
          "Formulá un nuevo pensamiento más realista y compasivo"
        ],
        duration: "10-15 minutos",
        research: "Técnica de TCC desarrollada por el Dr. Aaron Beck - Universidad de Pennsylvania"
      },
      {
        title: "Activación Conductual (Universidad de Washington)", 
        text: "La desesperanza often lleva a la inacción, creando un círculo vicioso. La activación conductual rompe este ciclo.",
        icon: "fas fa-walking",
        steps: [
          "Listá actividades que antes disfrutabas o que te daban sentido",
          "Empezá con actividades pequeñas y manejables (ej: dar una caminata de 5 minutos)",
          "Programá estas actividades en tu día",
          "Reflexioná después: ¿Cómo te sentiste durante y después?",
          "Aumentá gradualmente la dificultad y variedad de actividades"
        ],
        duration: "Variable",
        research: "Activación conductual para depresión - Universidad de Washington"
      },
      {
        title: "Visualización de Futuros Posibles (Terapia de Aceptación y Compromiso)", 
        text: "La desesperanza nubla la capacidad de imaginar futuros positivos. Esta técnica ayuda a recuperar esa capacidad.",
        icon: "fas fa-cloud-sun",
        steps: [
          "Imaginá que mientras dormís, ocurre un milagro y tu vida mejora significativamente",
          "Al despertar, ¿qué indicios notarías de que tu vida mejoró?",
          "¿Qué estarías haciendo diferente? ¿Cómo te sentirías?",
          "Identificá una pequeña acción que refleje este futuro mejor",
          "Realizá esa acción hoy, por pequeña que sea"
        ],
        duration: "10-15 minutos",
        research: "Adaptado de Terapia de Aceptación y Compromiso (ACT)"
      },
      {
        title: "Diario de Pequeñas Victorias", 
        text: "Registrar logros pequeños y momentos positivos diarios para contrarrestar la tendencia a enfocarse solo en lo negativo.",
        icon: "fas fa-trophy",
        steps: [
          "Cada día, anotá al menos 3 cosas que hiciste bien, por pequeñas que sean",
          "Incluí momentos en los que te cuidaste o mostraste compasión hacia ti mismo/a",
          "Anotá cualquier cosa positiva que ocurrió, incluso si no fue por tu acción directa",
          "Revisá tu diario semanalmente para ver patrones de progreso",
          "Celebra cada victoria, por pequeña que sea"
        ],
        duration: "5-10 minutos diarios",
        research: "Basado en técnicas de TCC y psicología positiva"
      },
      {
        title: "Técnica del Espectador Compasivo", 
        text: "Visualizar a un observador compasivo que te ve con bondad y comprensión, ayudando a desarrollar autocompasión.",
        icon: "fas fa-hands-helping",
        steps: [
          "Imaginá a una figura compasiva (puede ser real, ficticia, espiritual o una versión futura de ti mismo/a)",
          "Visualizá a esta figura observándote con ojos llenos de compasión y comprensión",
          "Imaginá lo que esta figura diría sobre tu situación actual",
          "Visualizá cómo esta figura te abraza o te ofrece consuelo",
          "Permítete recibir esta compasión, incluso si al principio se siente incómodo",
          "Practicá regularmente para fortalecer tu capacidad de autocompasión"
        ],
        duration: "10-15 minutos",
        research: "Adaptado de Terapia Centrada en la Compasión (Dr. Paul Gilbert)"
      }
    ],
    "estres": [
      {
        title: "Relajación Muscular Progressiva (Edmund Jacobson - Harvard)", 
        text: "Técnica que alterna tensión y relajación de grupos musculares para reducir la tensión física del estrés. Validada por investigación de Harvard.",
        icon: "fas fa-spa",
        steps: [
          "Tensá los músculos de tus pies durante 5 segundos",
          "Relajalos completamente por 10 segundos, notando la diferencia",
          "Subí gradualmente por todo tu cuerpo (piernas, glúteos, abdomen, pecho, brazos, manos, cuello, rostro)",
          "Tensá cada grupo muscular por 5 segundos y relajá por 10",
          "Terminá con una respiración profunda y scan corporal completo"
        ],
        duration: "15-20 minutos",
        research: "Técnica desarrollada por Edmund Jacobson, validada en Harvard"
      },
      {
        title: "Mindfulness del Body Scan (Universidad de Massachusetts)", 
        text: "Práctica de atención plena al cuerpo que reduce el estrés y aumenta la conciencia corporal. Del programa MBSR del Dr. Jon Kabat-Zinn.",
        icon: "fas fa-search",
        steps: [
          "Acostate boca arriba en un lugar cómodo",
          "Llevá tu atención a los dedos de los pies, notando sensaciones",
          "Mové lentamente tu atención por todo el cuerpo, parte por parte",
          "Cuando encuentres tensión, respirá hacia esa área",
          "No intentes cambiar nada, solo observá con curiosidad",
          "Completá el scan de todo el cuerpo de pies a cabeza"
        ],
        duration: "20-30 minutos",
        research: "Body Scan del programa MBSR - Universidad de Massachusetts"
      },
      {
        title: "Autocuidado Basado en Valores (Terapia de Aceptación y Compromiso)", 
        text: "Conectar con tus valores profundos te ayuda a elegir acciones de autocuidado significativas y sostenibles.",
        icon: "fas fa-heart",
        steps: [
          "Identificá 3-5 valores importantes para vos (ej: salud, familia, crecimiento, comunidad)",
          "Preguntate: ¿Cómo podría honrar estos valores en mi autocuidado?",
          "Planificá una acción pequeña para cada valor esta semana",
          "Reflexioná: ¿Cómo te sentís al cuidarte de manera alineada con tus valores?",
          "Ajustá según necesites para mantener la consistencia"
        ],
        duration: "15-20 minutos",
        research: "Basado en Terapia de Aceptación y Compromiso (ACT)"
      },
      {
        title: "Técnica de Contención Emocional (DBT)", 
        text: "Estrategias para manejar emociones intensas sin actuar impulsivamente, especialmente útil en momentos de estrés agudo.",
        icon: "fas fa-shield-alt",
        steps: [
          "DISTRAER: Haz algo que capture completamente tu atención (juego, película, conversación)",
          "AUTOCALMAR: Usa tus sentidos para calmarte (baño caliente, música relajante, aromaterapia)",
          "MEJORAR EL MOMENTO: Imagina un lugar seguro, reza o medita, encuentra el significado en el dolor",
          "PENSAR EN PROS Y CONTRAS: Considera las consecuencias a corto y largo plazo de actuar impulsivamente vs. resistir el impulso",
          "COMPARAR RADICALMENTE: Contrasta tu situación actual con situaciones peores para ganar perspectiva"
        ],
        duration: "Variable según la técnica elegida",
        research: "Técnicas de Distress Tolerance de DBT - Universidad de Washington"
      },
      {
        title: "Visualización de Lugar Seguro", 
        text: "Crear un refugio mental donde puedas retirarte cuando el estrés se vuelva abrumador, proporcionando un sentido de seguridad y calma.",
        icon: "fas fa-home",
        steps: [
          "Cierrá los ojos y respirá profundamente varias veces",
          "Imaginá un lugar donde te sientas completamente seguro, tranquilo y en paz",
          "Puede ser real o imaginario, interior o exterior",
          "Usá todos tus sentidos para enriquecer la visualización: ¿Qué ves? ¿Qué oyes? ¿Qué olores percibes? ¿Qué texturas sientes?",
          "Permanecé en este lugar el tiempo que necesites",
          "Cuando estés listo/a, regresá gradualmente a tu entorno actual",
          "Practicá regularmente para fortalecer este recurso mental"
        ],
        duration: "10-15 minutos",
        research: "Técnica utilizada en terapia de trauma, EMDR y terapia centrada en soluciones"
      }
    ],
    "depresion": [
      {
        title: "Activación Conductual (Universidad de Washington)", 
        text: "La depresión a menudo lleva a la inactividad, lo que empeora los síntomas. Esta técnica rompe el ciclo mediante la programación gradual de actividades.",
        icon: "fas fa-calendar-check",
        steps: [
          "Monitoreá tus actividades y estado de ánimo durante una semana para identificar patrones",
          "Listá actividades que antes disfrutabas o que te daban sentido",
          "Empezá con actividades pequeñas y manejables (ej: ducharte, salir a caminar 5 minutos)",
          "Programá estas actividades en tu calendario como citas importantes",
          "Cumplí con las actividades independientemente de cómo te sientas",
          "Reflexioná después: ¿Cómo te sentiste durante y después?",
          "Aumentá gradualmente la dificultad y variedad de actividades"
        ],
        duration: "Variable",
        research: "Activación conductual para depresión - Universidad de Washington"
      },
      {
        title: "Reestructuración Cognitiva (TCC - Universidad de Pennsylvania)", 
        text: "Identificar y desafiar pensamientos negativos automáticos que mantienen la depresión. Desarrollada por el Dr. Aaron Beck.",
        icon: "fas fa-brain",
        steps: [
          "Identificá pensamientos negativos recurrentes (Ej: 'Soy inútil', 'Nada vale la pena')",
          "Examiná la evidencia a favor y en contra de estos pensamientos",
          "Buscá interpretaciones alternativas más equilibradas y realistas",
          "Preguntate: '¿Qué le diría a un amigo que tuviera este pensamiento?'",
          "Desarrollá pensamientos más compasivos y realistas",
          "Practicá regularmente hasta que los nuevos pensamientos se vuelvan automáticos"
        ],
        duration: "15-20 minutos",
        research: "Técnica de TCC desarrollada por el Dr. Aaron Beck - Universidad de Pennsylvania"
      },
      {
        title: "Diario de Gratitud y Logros", 
        text: "Contrarrestar la tendencia depresiva a enfocarse en lo negativo mediante el registro diario de cosas positivas y logros.",
        icon: "fas fa-star",
        steps: [
          "Cada noche, anotá 3 cosas por las que estés agradecido/a ese día",
          "Anotá 3 cosas que hiciste bien, por pequeñas que sean",
          "Incluí momentos en los que te cuidaste o mostraste compasión hacia ti mismo/a",
          "Revisá tu diario semanalmente para ver patrones positivos",
          "Celebra cada logro y momento de gratitud"
        ],
        duration: "10 minutos diarios",
        research: "Basado en psicología positiva y TCC"
      },
      {
        title: "Técnica de la Silla Vacía (Terapia Gestalt)", 
        text: "Dialogar con diferentes partes de ti mismo/a o con figuras significativas para procesar emociones no resueltas que contribuyen a la depresión.",
        icon: "fas fa-chair",
        steps: [
          "Colocá dos sillas frente a frente",
          "Siéntate en una silla representando tu yo actual",
          "Imaginá que en la otra silla está otra parte de ti (ej: tu yo crítico, tu yo vulnerable) o una figura significativa",
          "Habla con esta parte/figura expresando lo que necesitas decir",
          "Cambia de silla y responde desde la perspectiva de la otra parte/figura",
          "Continuá el diálogo hasta que sientas cierto cierre o comprensión",
          "Terminá con una afirmación de autocompasión"
        ],
        duration: "20-30 minutos",
        research: "Técnica de Terapia Gestalt"
      },
      {
        title: "Compromiso con Valores (Terapia de Aceptación y Compromiso)", 
        text: "Conectar con tus valores profundos y comprometerte con acciones alineadas con ellos, incluso cuando te sientas deprimido/a.",
        icon: "fas fa-compass",
        steps: [
          "Identificá tus valores fundamentales en diferentes áreas (relaciones, trabajo, salud, crecimiento personal, etc.)",
          "Preguntate: '¿Qué tipo de persona quiero ser en esta área de mi vida?'",
          "Elige una acción pequeña y concreta que puedas hacer hoy para vivir según ese valor",
          "Haz esa acción independientemente de cómo te sientas",
          "Reflexioná: ¿Cómo te sentiste al actuar según tus valores?",
          "Repite diariamente con diferentes valores"
        ],
        duration: "15-20 minutos",
        research: "Basado en Terapia de Aceptación y Compromiso (ACT)"
      }
    ],
    "toc": [
      {
        title: "Exposición con Prevención de Respuesta (TCC - Universidad de Pennsylvania)", 
        text: "Técnica gold standard para TOC: exponerse gradualmente a los desencadenantes de obsesiones sin realizar las compulsiones.",
        icon: "fas fa-shield-virus",
        steps: [
          "Identificá tus obsesiones y compulsiones principales",
          "Creá una jerarquía de miedos (situaciones que desencadenan obsesiones, de menor a mayor ansiedad)",
          "Exponte a la situación menos ansiosa sin realizar la compulsión",
          "Permanecé en la situación hasta que tu ansiedad disminuya significativamente (al menos 50%)",
          "Repetí la exposición hasta que ya no genere ansiedad",
          "Pasá a la siguiente situación en tu jerarquía",
          "Practicá regularmente para consolidar los avances"
        ],
        duration: "30-60 minutos por sesión",
        research: "Técnica de TCC validada para TOC - Universidad de Pennsylvania"
      },
      {
        title: "Reestructuración Cognitiva para TOC", 
        text: "Desafiar las creencias subyacentes que alimentan las obsesiones y compulsiones.",
        icon: "fas fa-brain",
        steps: [
          "Identificá las creencias subyacentes a tus obsesiones (Ej: 'Si no verifico la puerta 10 veces, algo terrible ocurrirá')",
          "Examiná la evidencia a favor y en contra de estas creencias",
          "Calculá la probabilidad real de que ocurra lo que temes",
          "Considerá las consecuencias de tus compulsiones (¿Qué te cuestan en tiempo, energía, calidad de vida?)",
          "Desarrollá creencias más realistas y equilibradas",
          "Practicá regularmente, especialmente antes de las exposiciones"
        ],
        duration: "20-30 minutos",
        research: "Adaptado de TCC para TOC"
      },
      {
        title: "Mindfulness para Pensamientos Intrusivos", 
        text: "Aprender a observar los pensamientos obsesivos sin juzgarlos ni intentar eliminarlos, reduciendo su poder.",
        icon: "fas fa-leaf",
        steps: [
          "Cuando surja un pensamiento obsesivo, reconocelo: 'Ah, ahí está ese pensamiento otra vez'",
          "Imaginá los pensamientos como hojas flotando en un río, o nubes pasando en el cielo",
          "No intentes empujarlos lejos ni analizarlos",
          "Simplemente obsérvalos venir y irse",
          "Volvé suavemente tu atención a tu respiración o a tu actividad actual",
          "Practicá regularmente, especialmente cuando los pensamientos son menos intensos"
        ],
        duration: "10-15 minutos",
        research: "Basado en Terapia de Aceptación y Compromiso (ACT) y Mindfulness"
      },
      {
        title: "Retraso de la Compulsión", 
        text: "Técnica de reducción gradual de compulsiones mediante el retraso progresivo de su realización.",
        icon: "fas fa-clock",
        steps: [
          "Cuando sientas el impulso de realizar una compulsión, decidí retrasarla por un tiempo específico (empezá con 5-10 minutos)",
          "Durante el retraso, usá técnicas de distracción o mindfulness",
          "Cuando termine el tiempo, evaluá si aún necesitás realizar la compulsión",
          "Si la realizás, anotá cuánto alivio proporcionó y por cuánto tiempo",
          "Gradualmente aumentá el tiempo de retraso (15 min, 30 min, 1 hora, etc.)",
          "Celebrá cada vez que logres retrasar o evitar una compulsión"
        ],
        duration: "Variable",
        research: "Técnica de modificación de conducta para TOC"
      },
      {
        title: "Técnica de la Cinta de Correr Mental", 
        text: "Ejercicio para reducir la importancia asignada a los pensamientos obsesivos mediante la repetición hasta el aburrimiento.",
        icon: "fas fa-running",
        steps: [
          "Identificá tu pensamiento obsesivo más perturbador",
          "Grabalo en tu teléfono o escríbelo en una tarjeta",
          "Repetí el pensamiento en voz alta o en tu mente durante 15-20 minutos",
          "Hacelo de manera monótona, sin emoción, como un robot",
          "Continuá incluso si te aburrís o el pensamiento pierde su impacto emocional",
          "Repetí diariamente hasta que el pensamiento pierda su poder perturbador"
        ],
        duration: "15-20 minutos diarios",
        research: "Técnica basada en la habituación y la terapia cognitiva"
      }
    ],
    "panico": [
      {
        title: "Reestructuración Cognitiva de Catastrofización", 
        text: "Desafiar la interpretación catastrófica de las sensaciones corporales que caracteriza los ataques de pánico.",
        icon: "fas fa-brain",
        steps: [
          "Identificá las sensaciones corporales que te asustan durante un ataque de pánico",
          "Anotá tus interpretaciones catastróficas de estas sensaciones (Ej: 'Me voy a morir', 'Voy a enloquecer')",
          "Buscá explicaciones alternativas más realistas (Ej: 'Es solo ansiedad, no es peligroso', 'Estas sensaciones son desagradables pero no dañinas')",
          "Reuní evidencia de que has tenido estas sensaciones antes y no ha ocurrido lo que temías",
          "Desarrollá afirmaciones realistas para repetir cuando surjan las sensaciones ('Esto es incómodo pero pasará', 'Mi cuerpo está reaccionando al estrés, no al peligro')",
          "Practicá regularmente, especialmente cuando no estás en crisis"
        ],
        duration: "20-30 minutos",
        research: "Técnica de TCC para trastorno de pánico"
      },
      {
        title: "Exposición Interoceptiva", 
        text: "Exponerte deliberadamente a las sensaciones corporales temidas para aprender que no son peligrosas.",
        icon: "fas fa-heartbeat",
        steps: [
          "Identificá las sensaciones corporales que más miedo te causan (mareo, palpitaciones, falta de aire, etc.)",
          "Elige ejercicios que produzcan esas sensaciones de manera segura (girar en silla para mareo, correr en lugar para palpitaciones, respirar por pajita para falta de aire)",
          "Realizá el ejercicio durante 1-2 minutos",
          "Permanecé con la sensación sin escapar, observándola con curiosidad",
          "Notá cómo la sensación alcanza un pico y luego disminuye naturalmente",
          "Repetí hasta que la sensación ya no genere miedo",
          "Pasá a la siguiente sensación en tu lista"
        ],
        duration: "20-30 minutos por sesión",
        research: "Técnica de TCC validada para trastorno de pánico"
      },
      {
        title: "Respiración Diafragmática Controlada", 
        text: "Aprender a respirar desde el diafragma en lugar del pecho para reducir la hiperventilación y las sensaciones de pánico.",
        icon: "fas fa-wind",
        steps: [
          "Acostate boca arriba con una mano en el pecho y otra en el abdomen",
          "Inhalá lentamente por la nariz, permitiendo que tu abdomen se eleve (la mano en el pecho debe moverse poco)",
          "Exhalá lentamente por la boca, permitiendo que tu abdomen baje",
          "Mantené un ritmo de 6-8 respiraciones por minuto (inhalar 4 segundos, exhalar 6 segundos)",
          "Practicá 10-15 minutos diarios hasta que se vuelva automático",
          "Usá esta respiración cuando sientas que un ataque de pánico se aproxima"
        ],
        duration: "10-15 minutos diarios",
        research: "Técnica de manejo de ansiedad validada"
      },
      {
        title: "Técnica de Anclaje en el Presente", 
        text: "Técnicas para reconectar con el entorno actual cuando sientes que un ataque de pánico se aproxima.",
        icon: "fas fa-anchor",
        steps: [
          "MIRAR: Identificá 5 cosas que puedes ver a tu alrededor, descríbelas en detalle",
          "TOCAR: Identificá 4 cosas que puedes tocar, enfócate en sus texturas y temperaturas",
          "OÍR: Identificá 3 sonidos que puedes oír, descríbelos",
          "OLER: Identificá 2 aromas que puedes oler (o recuerda aromas agradables)",
          "SABOREAR: Identificá 1 cosa que puedes saborear (o mueve la lengua por tu boca)",
          "Respirá profundamente entre cada paso",
          "Repetí si es necesario hasta sentirte más conectado/a con el presente"
        ],
        duration: "3-5 minutos",
        research: "Técnica de grounding para ansiedad y pánico"
      },
      {
        title: "Registro de Ataques de Pánico", 
        text: "Monitorear tus ataques de pánico para identificar patrones, desencadenantes y progreso en el tratamiento.",
        icon: "fas fa-clipboard-list",
        steps: [
          "Cada vez que tengas un ataque de pánico, registrá la fecha y hora",
          "Anotá dónde estabas y qué estabas haciendo",
          "Identificá qué pensamientos tuviste antes y durante el ataque",
          "Registra las sensaciones corporales que experimentaste y su intensidad (1-10)",
          "Anotá qué estrategias usaste para manejarlo y qué tan efectivas fueron",
          "Registra cuánto duró el ataque y cómo te sentiste después",
          "Revisa tu registro semanalmente para identificar patrones y progreso"
        ],
        duration: "5-10 minutos por ataque",
        research: "Técnica de auto-monitoreo en TCC para trastorno de pánico"
      }
    ]
  };
  
  // Mostrar técnicas
  function showCrisisTechniques(crisis) {
    currentCrisis = crisis;
    currentTechniqueIndex = 0;
    updateProgressBar();
    renderTechnique();
    document.getElementById("prevBtn").disabled = true;
    document.getElementById("nextBtn").disabled = !crisisTechniques[currentCrisis] || crisisTechniques[currentCrisis].length <= 1;
  }
  
  function renderTechnique() {
    const container = document.getElementById("technique-content");
    if (!currentCrisis || !crisisTechniques[currentCrisis]) return;
    const technique = crisisTechniques[currentCrisis][currentTechniqueIndex];
    
    let stepsHTML = '';
    if (technique.steps) {
      stepsHTML = '<div class="technique-steps">';
      technique.steps.forEach((step, index) => {
        stepsHTML += `
          <div class="technique-step">
            <strong>Paso ${index + 1}:</strong> ${step}
          </div>
        `;
      });
      stepsHTML += '</div>';
    }
    
    let researchHTML = '';
    if (technique.research) {
      researchHTML = `
        <div class="technique-resources">
          <p><i class="fas fa-graduation-cap"></i> <strong>Base científica:</strong> ${technique.research}</p>
        </div>
      `;
    }
    
    container.innerHTML = `
      <div class="technique-header">
        <div class="technique-icon">
          <i class="${technique.icon}"></i>
        </div>
        <div>
          <h3>${technique.title}</h3>
          <p><i class="fas fa-clock"></i> Duración recomendada: ${technique.duration}</p>
        </div>
      </div>
      <p>${technique.text}</p>
      ${stepsHTML}
      ${researchHTML}
    `;
    
    // Actualizar estado de botones
    document.getElementById("prevBtn").disabled = currentTechniqueIndex === 0;
    document.getElementById("nextBtn").disabled = currentTechniqueIndex === crisisTechniques[currentCrisis].length - 1;
  }
  
  function nextTechnique() {
    if (!currentCrisis || !crisisTechniques[currentCrisis]) return;
    if (currentTechniqueIndex < crisisTechniques[currentCrisis].length - 1) {
      currentTechniqueIndex++;
      updateProgressBar();
      renderTechnique();
    }
  }
  
  function prevTechnique() {
    if (!currentCrisis || !crisisTechniques[currentCrisis]) return;
    if (currentTechniqueIndex > 0) {
      currentTechniqueIndex--;
      updateProgressBar();
      renderTechnique();
    }
  }
  
  function updateProgressBar() {
    if (!currentCrisis || !crisisTechniques[currentCrisis]) return;
    const progress = ((currentTechniqueIndex + 1) / crisisTechniques[currentCrisis].length) * 100;
    document.getElementById("technique-progress").style.width = `${progress}%`;
  }
  
  // Temporizador de respiración
  function toggleBreathing() {
    const playIcon = document.getElementById('breath-play-icon');
    const circle = document.getElementById('breath-circle');
    if (playIcon.classList.contains('fa-play')) {
      // Iniciar respiración
      playIcon.classList.remove('fa-play');
      playIcon.classList.add('fa-pause');
      circle.classList.remove('hidden');
      let seconds = 300; // 5 minutos
      let phase = 'inhalar';
      let phaseCount = 0;
      breathingInterval = setInterval(() => {
        seconds--;
        const minutes = Math.floor(seconds / 60);
        const remainingSeconds = seconds % 60;
        document.getElementById('breath-timer').textContent = 
          `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
        // Cambiar fases de respiración cada 4 segundos
        if (phaseCount % 4 === 0) {
          if (phase === 'inhalar') {
            phase = 'mantener';
            circle.textContent = 'Mantener';
          } else if (phase === 'mantener') {
            phase = 'exhalar';
            circle.textContent = 'Exhalar';
          } else {
            phase = 'inhalar';
            circle.textContent = 'Inhalar';
          }
        }
        phaseCount++;
        if (seconds <= 0) {
          clearInterval(breathingInterval);
          playIcon.classList.remove('fa-pause');
          playIcon.classList.add('fa-play');
          circle.classList.add('hidden');
          document.getElementById('breath-timer').textContent = '05:00';
        }
      }, 1000);
    } else {
      // Pausar respiración
      playIcon.classList.remove('fa-pause');
      playIcon.classList.add('fa-play');
      clearInterval(breathingInterval);
    }
  }
  
  // Temporizador de body scan
  function toggleBodyScan() {
    const playIcon = document.getElementById('bodyscan-play-icon');
    if (playIcon.classList.contains('fa-play')) {
      playIcon.classList.remove('fa-play');
      playIcon.classList.add('fa-pause');
      let seconds = 600; // 10 minutos
      bodyScanInterval = setInterval(() => {
        seconds--;
        const minutes = Math.floor(seconds / 60);
        const remainingSeconds = seconds % 60;
        document.getElementById('bodyscan-timer').textContent = 
          `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
        if (seconds <= 0) {
          clearInterval(bodyScanInterval);
          playIcon.classList.remove('fa-pause');
          playIcon.classList.add('fa-play');
          document.getElementById('bodyscan-timer').textContent = '10:00';
          alert('Meditación de body scan completada. ¿Cómo te sentís?');
        }
      }, 1000);
    } else {
      playIcon.classList.remove('fa-pause');
      playIcon.classList.add('fa-play');
      clearInterval(bodyScanInterval);
    }
  }
  
  // Temporizador de mindfulness
  function toggleMindfulness() {
    const playIcon = document.getElementById('mindfulness-play-icon');
    if (playIcon.classList.contains('fa-play')) {
      playIcon.classList.remove('fa-play');
      playIcon.classList.add('fa-pause');
      let seconds = 480; // 8 minutos
      mindfulnessInterval = setInterval(() => {
        seconds--;
        const minutes = Math.floor(seconds / 60);
        const remainingSeconds = seconds % 60;
        document.getElementById('mindfulness-timer').textContent = 
          `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
        if (seconds <= 0) {
          clearInterval(mindfulnessInterval);
          playIcon.classList.remove('fa-pause');
          playIcon.classList.add('fa-play');
          document.getElementById('mindfulness-timer').textContent = '08:00';
          alert('Meditación de mindfulness completada. Esperamos que te sientas más presente y centrado.');
        }
      }, 1000);
    } else {
      playIcon.classList.remove('fa-pause');
      playIcon.classList.add('fa-play');
      clearInterval(mindfulnessInterval);
    }
  }
  
  // Diario personal
  function saveJournalEntry() {
    const entryText = document.getElementById('journalEntry').value.trim();
    if (!entryText) {
      alert('Por favor, escribí algo antes de guardar.');
      return;
    }
    const entry = {
      date: new Date().toLocaleString('es-AR'),
      content: entryText
    };
    let journalEntries = JSON.parse(localStorage.getItem('journalEntries') || '[]');
    journalEntries.push(entry);
    localStorage.setItem('journalEntries', JSON.stringify(journalEntries));
    document.getElementById('journalEntry').value = '';
    loadJournalEntries();
    alert('Entrada guardada correctamente.');
    updateProgressStats();
  }
  
  function loadJournalEntries() {
    const journalEntries = JSON.parse(localStorage.getItem('journalEntries') || '[]');
    const entriesContainer = document.getElementById('journal-entries');
    if (journalEntries.length === 0) {
      entriesContainer.innerHTML = `
        <div class="empty-journal">
          <i class="fas fa-book-open"></i>
          <p>No tenés entradas en tu diario todavía.</p>
        </div>
      `;
      return;
    }
    entriesContainer.innerHTML = journalEntries.map((entry, index) => `
      <div class="journal-entry">
        <div class="journal-date">${entry.date}</div>
        <div class="journal-content">${entry.content}</div>
        <div class="journal-actions">
          <button class="btn-secondary" onclick="deleteJournalEntry(${index})"><i class="fas fa-trash"></i> Eliminar</button>
        </div>
      </div>
    `).join('');
  }
  
  function deleteJournalEntry(index) {
    let journalEntries = JSON.parse(localStorage.getItem('journalEntries') || '[]');
    journalEntries.splice(index, 1);
    localStorage.setItem('journalEntries', JSON.stringify(journalEntries));
    loadJournalEntries();
    updateProgressStats();
  }
  
  function downloadJournal() {
    const journalEntries = JSON.parse(localStorage.getItem('journalEntries') || '[]');
    if (journalEntries.length === 0) {
      alert('No hay entradas para descargar.');
      return;
    }
    let content = 'Mi Diario - Serenamente\n\n';
    journalEntries.forEach(entry => {
      content += `Fecha: ${entry.date}\n`;
      content += `Contenido: ${entry.content}\n\n`;
    });
    const blob = new Blob([content], { type: 'text/plain' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `mi-diario-serenamente-${new Date().toISOString().slice(0, 10)}.txt`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  }
  
  // Actividades de bienestar
  function startActivity(activityType) {
    switch(activityType) {
      case 'gratitude':
        const gratitudeText = prompt("Escribí tres cosas por las que estés agradecido hoy:");
        if (gratitudeText) {
          saveJournalEntryWithPrefix("Diario de Gratitud: " + gratitudeText);
          habits.gratitude++;
          saveToStorage();
          updateHabitCounts();
          alert("¡Excelente! Practicar gratitud regularmente puede cambiar tu perspectiva. Se ha guardado en tu diario.");
        }
        break;
      case 'pleasure':
        const pleasureText = prompt("Planificá 2-3 actividades placenteras para los próximos días. Podrían ser cosas simples como leer, caminar, o llamar a un amigo:");
        if (pleasureText) {
          saveJournalEntryWithPrefix("Actividades Placenteras: " + pleasureText);
          alert("¡Perfecto! Programar actividades placenteras es clave para el bienestar. Se ha guardado en tu diario.");
        }
        break;
      case 'cognitive':
        nextStep('activities-section', 'thought-record-section');
        break;
    }
  }
  
  function saveJournalEntryWithPrefix(text) {
    const entry = {
      date: new Date().toLocaleString('es-AR'),
      content: text
    };
    let journalEntries = JSON.parse(localStorage.getItem('journalEntries') || '[]');
    journalEntries.push(entry);
    localStorage.setItem('journalEntries', JSON.stringify(journalEntries));
    loadJournalEntries();
    updateProgressStats();
  }
  
  // Registro de pensamientos
  function saveThoughtRecord() {
    const situation = document.getElementById('situation').value.trim();
    const emotion = document.getElementById('emotion').value.trim();
    const automaticThought = document.getElementById('automaticThought').value.trim();
    
    if (!situation || !emotion || !automaticThought) {
      alert('Por favor, completá al menos la situación, emoción y pensamiento automático.');
      return;
    }
    
    const thoughtRecord = {
      situation: situation,
      emotion: emotion,
      automaticThought: automaticThought,
      evidenceFor: document.getElementById('evidenceFor').value.trim(),
      evidenceAgainst: document.getElementById('evidenceAgainst').value.trim(),
      balancedThought: document.getElementById('balancedThought').value.trim(),
      date: new Date().toLocaleString('es-AR')
    };
    
    // Guardar en el diario
    const journalEntry = {
      date: thoughtRecord.date,
      content: `REGISTRO DE PENSAMIENTOS\n\nSituación: ${thoughtRecord.situation}\nEmoción: ${thoughtRecord.emotion}\nPensamiento automático: ${thoughtRecord.automaticThought}\nEvidencia a favor: ${thoughtRecord.evidenceFor}\nEvidencia en contra: ${thoughtRecord.evidenceAgainst}\nPensamiento equilibrado: ${thoughtRecord.balancedThought}`
    };
    
    let journalEntries = JSON.parse(localStorage.getItem('journalEntries') || '[]');
    journalEntries.push(journalEntry);
    localStorage.setItem('journalEntries', JSON.stringify(journalEntries));
    
    // Limpiar formulario
    document.getElementById('situation').value = '';
    document.getElementById('emotion').value = '';
    document.getElementById('automaticThought').value = '';
    document.getElementById('evidenceFor').value = '';
    document.getElementById('evidenceAgainst').value = '';
    document.getElementById('balancedThought').value = '';
    
    loadJournalEntries();
    alert('Registro de pensamientos guardado en tu diario.');
    nextStep('thought-record-section', 'activities-section');
  }
  
  // Registro de hábitos
  function recordHabit(habit) {
    habits[habit]++;
    saveToStorage();
    updateHabitCounts();
    alert(`¡Excelente! Has registrado tu actividad de ${habit}.`);
  }
  
  function updateHabitCounts() {
    document.getElementById('exercise-count').textContent = habits.exercise;
    document.getElementById('meditation-count').textContent = habits.meditation;
    document.getElementById('nature-count').textContent = habits.nature;
    document.getElementById('gratitude-count').textContent = habits.gratitude;
  }
  
  // Gestión de metas
  function addGoal() {
    const goalText = document.getElementById('goalInput').value.trim();
    if (!goalText) {
      alert('Por favor, escribí una meta antes de agregarla.');
      return;
    }
    
    const newGoal = {
      id: Date.now(),
      text: goalText,
      completed: false,
      createdAt: new Date().toISOString()
    };
    
    goals.push(newGoal);
    saveToStorage();
    renderGoals();
    document.getElementById('goalInput').value = '';
    alert('Meta agregada correctamente.');
  }
  
  function toggleGoal(id) {
    goals = goals.map(goal => {
      if (goal.id === id) {
        return { ...goal, completed: !goal.completed };
      }
      return goal;
    });
    saveToStorage();
    renderGoals();
  }
  
  function deleteGoal(id) {
    goals = goals.filter(goal => goal.id !== id);
    saveToStorage();
    renderGoals();
  }
  
  function renderGoals() {
    const goalsList = document.getElementById('goals-list');
    if (goals.length === 0) {
      goalsList.innerHTML = '<p class="text-gray-500 dark:text-gray-400 text-center">No tenés metas establecidas todavía.</p>';
      return;
    }
    
    goalsList.innerHTML = goals.map(goal => `
      <div class="goal-item">
        <div class="goal-text ${goal.completed ? 'goal-completed' : ''}">
          ${goal.text}
        </div>
        <div class="goal-actions">
          <button onclick="toggleGoal(${goal.id})" class="btn-secondary">
            <i class="fas ${goal.completed ? 'fa-undo' : 'fa-check'}"></i>
          </button>
          <button onclick="deleteGoal(${goal.id})" class="btn-secondary">
            <i class="fas fa-trash"></i>
          </button>
        </div>
      </div>
    `).join('');
  }
  
  // Análisis de nivel de riesgo
  function analyzeRiskLevel() {
    if (moodHistory.length === 0) return;
    
    const recentEntries = moodHistory.slice(-7); // Last 7 entries
    const suicidalEntries = recentEntries.filter(entry => entry.mood === 'suicida').length;
    const severeMoodEntries = recentEntries.filter(entry => 
      ['suicida', 'trauma', 'desesperanza'].includes(entry.mood)
    ).length;
    
    const riskIndicator = document.getElementById('risk-indicator');
    riskIndicator.classList.remove('hidden', 'risk-low', 'risk-medium', 'risk-high', 'risk-critical');
    
    if (suicidalEntries > 0) {
      riskIndicator.classList.add('risk-critical');
      riskIndicator.innerHTML = `
        <i class="fas fa-skull-crossbones risk-icon"></i>
        <div>
          <h3 class="font-bold text-red-800 dark:text-red-300">Nivel de Riesgo: Crítico</h3>
          <p class="text-red-700 dark:text-red-300">Por favor, contactá inmediatamente con servicios de emergencia o líneas de crisis.</p>
          <p class="font-bold text-red-800 dark:text-red-300 mt-2">0800 345 1435 - Centro de Asistencia al Suicida</p>
        </div>
      `;
    } else if (severeMoodEntries >= 3) {
      riskIndicator.classList.add('risk-high');
      riskIndicator.innerHTML = `
        <i class="fas fa-exclamation-circle risk-icon"></i>
        <div>
          <h3 class="font-bold text-orange-800 dark:text-orange-300">Nivel de Riesgo: Alto</h3>
          <p class="text-orange-700 dark:text-orange-300">Te recomendamos contactar con un profesional de salud mental lo antes posible.</p>
        </div>
      `;
    } else if (severeMoodEntries >= 1) {
      riskIndicator.classList.add('risk-medium');
      riskIndicator.innerHTML = `
        <i class="fas fa-exclamation-triangle risk-icon"></i>
        <div>
          <h3 class="font-bold text-yellow-800 dark:text-yellow-300">Nivel de Riesgo: Medio</h3>
          <p class="text-yellow-700 dark:text-yellow-300">Considerá buscar apoyo profesional para manejar mejor tus síntomas.</p>
        </div>
      `;
    } else {
      riskIndicator.classList.add('risk-low');
      riskIndicator.innerHTML = `
        <i class="fas fa-check-circle risk-icon"></i>
        <div>
          <h3 class="font-bold text-green-800 dark:text-green-300">Nivel de Riesgo: Bajo</h3>
          <p class="text-green-700 dark:text-green-300">Continuá con tus prácticas de autocuidado.</p>
        </div>
      `;
    }
  }
  
  // Generar gráfico de ánimo
  function generateMoodChart() {
    if (moodHistory.length === 0) return;
    
    const chartContainer = document.getElementById('mood-chart');
    chartContainer.innerHTML = '';
    
    const recentEntries = moodHistory.slice(-7);
    const moodColors = {
      'suicida': '#ef4444',
      'desesperanza': '#f97316',
      'trauma': '#9333ea',
      'ansiedad': '#f59e0b',
      'estres': '#3b82f6',
      'duelo': '#6b7280',
      'depresion': '#8b5cf6',
      'toc': '#ec4899',
      'panico': '#10b981'
    };
    
    recentEntries.forEach((entry, index) => {
      const date = new Date(entry.date);
      const day = date.getDate();
      const height = Math.random() * 80 + 20; // Random height between 20% and 100%
      const mood = entry.mood;
      
      const bar = document.createElement('div');
      bar.className = 'chart-bar';
      bar.style.height = `${height}%`;
      bar.style.backgroundColor = moodColors[mood] || '#3b82f6';
      
      const label = document.createElement('div');
      label.className = 'chart-label';
      label.textContent = `${day}`;
      
      bar.appendChild(label);
      chartContainer.appendChild(bar);
    });
  }
  
  // Actualizar estadísticas de progreso
  function updateProgressStats() {
    const journalEntries = JSON.parse(localStorage.getItem('journalEntries') || '[]');
    document.getElementById('entries-count').textContent = journalEntries.length;
    
    // Días registrados
    const firstEntryDate = localStorage.getItem('firstEntryDate');
    if (firstEntryDate) {
      const firstDate = new Date(firstEntryDate);
      const today = new Date();
      const diffTime = Math.abs(today - firstDate);
      const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
      document.getElementById('days-tracked').textContent = diffDays;
    }
    
    // Técnicas probadas
    if (currentCrisis && crisisTechniques[currentCrisis]) {
      document.getElementById('techniques-tried').textContent = currentTechniqueIndex + 1;
    }
  }
  
  // Guardar y cargar datos
  function saveToStorage() {
    localStorage.setItem('moodHistory', JSON.stringify(moodHistory));
    localStorage.setItem('habits', JSON.stringify(habits));
    localStorage.setItem('goals', JSON.stringify(goals));
  }
  
  function loadFromStorage() {
    // Cargar historial de ánimo
    const savedMoodHistory = localStorage.getItem('moodHistory');
    if (savedMoodHistory) {
      moodHistory = JSON.parse(savedMoodHistory);
      analyzeRiskLevel();
    }
    
    // Cargar hábitos
    const savedHabits = localStorage.getItem('habits');
    if (savedHabits) {
      habits = JSON.parse(savedHabits);
      updateHabitCounts();
    }
    
    // Cargar metas
    const savedGoals = localStorage.getItem('goals');
    if (savedGoals) {
      goals = JSON.parse(savedGoals);
      renderGoals();
    }
    
    // Cargar entradas de diario
    loadJournalEntries();
  }
  
  // Inicializar
  document.addEventListener('DOMContentLoaded', function() {
    loadFromStorage();
    updateProgressStats();
    generateMoodChart();
    updateHabitCounts();
    renderGoals();
    analyzeRiskLevel();
    
    // Configurar modo oscuro
    document.getElementById('darkModeToggle').addEventListener('change', function(){
      document.body.classList.toggle('dark-mode');
    });
    
    // Configurar consentimiento
    document.getElementById('consentCheck').addEventListener('change', function(){
      document.getElementById('consentBtn').disabled = !this.checked;
    });
    
    // Configurar selección de estado de ánimo
    document.querySelectorAll('.mood').forEach(el => {
      el.addEventListener('click', function() {
        document.querySelectorAll('.mood').forEach(m => m.classList.remove('selected'));
        this.classList.add('selected');
        const crisis = this.dataset.value;
        currentCrisis = crisis;
        setTheme(crisis);
        
        // Guardar en historial de ánimo
        moodHistory.push({
          mood: crisis,
          date: new Date().toISOString()
        });
        saveToStorage();
        analyzeRiskLevel();
        
        if(crisis === 'suicida') {
          nextStep('mood-section','crisis-section');
        } else {
          nextStep('mood-section','techniques-section');
          showCrisisTechniques(crisis);
        }
      });
    });
  
  // Funciones para módulo CBT avanzado
  const cognitiveDistortions = {
    catastrophizing: {
      title: "Catastrofización",
      description: "Imaginar el peor escenario posible o exagerar las consecuencias negativas de una situación.",
      example: "Ejemplo: 'Si cometo un error en esta presentación, me van a despedir y nunca voy a conseguir otro trabajo.'",
      challenge: "Desafío: Preguntate: ¿Cuál es la probabilidad real de que ocurra el peor escenario? ¿Qué evidencia tengo de que esto realmente va a pasar? ¿Hay resultados menos extremos más probables?"
    },
    allOrNothing: {
      title: "Pensamiento Todo o Nada",
      description: "Ver las situaciones en términos absolutos, sin considerar los grises intermedios.",
      example: "Ejemplo: 'Soy un completo fracaso' o 'Si no es perfecto, no vale la pena.'",
      challenge: "Desafío: Buscá evidencia de términos medios. ¿Realmente es 'todo' o 'nada'? ¿Podés pensar en una escala del 1 al 10 en lugar de solo 1 o 10?"
    },
    mindReading: {
      title: "Lectura Mental",
      description: "Asumir que sabés lo que otros están pensando sin evidencia real.",
      example: "Ejemplo: 'Seguro que piensa que soy estúpido' o 'Todos me están juzgando.'",
      challenge: "Desafío: Preguntate: ¿Tengo evidencia real de lo que está pensando esta persona? ¿Podría haber explicaciones alternativas para su comportamiento?"
    },
    personalization: {
      title: "Personalización",
      description: "Culparte por eventos que están fuera de tu control o asumir que todo es sobre ti.",
      example: "Ejemplo: 'Mi amigo está de mal humor, debe ser por algo que hice' o 'El proyecto falló por mi culpa.'",
      challenge: "Desafío: Considerá otros factores que podrían estar influyendo. ¿Qué porcentaje de responsabilidad realmente tenés en esta situación?"
    },
    filtering: {
      title: "Filtro Mental",
      description: "Enfocarse únicamente en los aspectos negativos mientras ignorás los positivos.",
      example: "Ejemplo: Recibir 9 comentarios positivos y 1 negativo, pero solo recordar el negativo.",
      challenge: "Desafío: Hacé una lista equilibrada de aspectos positivos y negativos. ¿Estás ignorando información importante?"
    },
    labeling: {
      title: "Etiquetado",
      description: "Asignar etiquetas globales negativas a vos mismo o a otros basándote en un solo evento.",
      example: "Ejemplo: 'Soy un perdedor' después de un error, o 'Es un idiota' después de un desacuerdo.",
      challenge: "Desafío: Reemplazá las etiquetas por descripciones específicas del comportamiento. En lugar de 'Soy tonto', decí 'Cometí un error en esta situación específica.'"
    }
  };

  function showDistortionInfo(type) {
    const distortion = cognitiveDistortions[type];
    const infoDiv = document.getElementById('distortion-info');
    
    document.getElementById('distortion-title').textContent = distortion.title;
    document.getElementById('distortion-description').textContent = distortion.description;
    document.getElementById('distortion-example').innerHTML = `<strong>📝 ${distortion.example}</strong>`;
    document.getElementById('distortion-challenge').innerHTML = `<strong>🎯 ${distortion.challenge}</strong>`;
    
    infoDiv.classList.remove('hidden');
  }

  function saveABCRecord() {
    const activator = document.getElementById('abc-activator').value.trim();
    const belief = document.getElementById('abc-belief').value.trim();
    const consequence = document.getElementById('abc-consequence').value.trim();
    const dispute = document.getElementById('abc-dispute').value.trim();
    const effective = document.getElementById('abc-effective').value.trim();

    if (!activator || !belief || !consequence) {
      alert('Por favor, completá al menos los campos A, B y C.');
      return;
    }

    const abcRecord = {
      activator, belief, consequence, dispute, effective,
      date: new Date().toLocaleString('es-AR')
    };

    // Guardar en el diario
    const journalContent = `ANÁLISIS ABC - TCC
Fecha: ${abcRecord.date}
A (Activador): ${activator}
B (Creencia): ${belief}
C (Consecuencia): ${consequence}
D (Disputa): ${dispute}
E (Efectivo nuevo): ${effective}`;

    saveJournalEntryWithPrefix(journalContent);
    
    // Limpiar formulario
    document.getElementById('abc-activator').value = '';
    document.getElementById('abc-belief').value = '';
    document.getElementById('abc-consequence').value = '';
    document.getElementById('abc-dispute').value = '';
    document.getElementById('abc-effective').value = '';
    
    alert('Análisis ABC guardado en tu diario. ¡Excelente trabajo explorando tus patrones de pensamiento!');
  }

  let behaviorEntries = JSON.parse(localStorage.getItem('behaviorEntries') || '[]');

  function saveBehaviorTracking() {
    const activity = document.getElementById('activity-input').value.trim();
    const moodBefore = document.getElementById('mood-before').value;
    const moodAfter = document.getElementById('mood-after').value;
    const satisfaction = document.getElementById('satisfaction-level').value;

    if (!activity) {
      alert('Por favor, describí la actividad realizada.');
      return;
    }

    const entry = {
      activity,
      moodBefore: parseInt(moodBefore),
      moodAfter: parseInt(moodAfter),
      satisfaction: parseInt(satisfaction),
      date: new Date().toLocaleString('es-AR')
    };

    behaviorEntries.push(entry);
    localStorage.setItem('behaviorEntries', JSON.stringify(behaviorEntries));
    
    // Limpiar formulario
    document.getElementById('activity-input').value = '';
    document.getElementById('mood-before').value = 5;
    document.getElementById('mood-after').value = 5;
    document.getElementById('satisfaction-level').value = 5;
    updateMoodValues();
    
    displayBehaviorEntries();
    alert('Actividad registrada correctamente. ¡Seguí registrando para identificar patrones!');
  }

  function displayBehaviorEntries() {
    const container = document.getElementById('behavior-entries');
    if (behaviorEntries.length === 0) {
      container.innerHTML = '<p class="text-gray-500">No hay actividades registradas todavía.</p>';
      return;
    }

    container.innerHTML = behaviorEntries.slice(-5).reverse().map(entry => `
      <div class="behavior-entry">
        <strong>${entry.activity}</strong> - ${entry.date}<br>
        Estado de ánimo: ${entry.moodBefore} → ${entry.moodAfter} 
        ${entry.moodAfter > entry.moodBefore ? '📈' : entry.moodAfter < entry.moodBefore ? '📉' : '➡️'}<br>
        Satisfacción: ${entry.satisfaction}/10 ${'⭐'.repeat(Math.ceil(entry.satisfaction/2))}
      </div>
    `).join('');
  }

  function updateMoodValues() {
    const moodBeforeEl = document.getElementById('mood-before-value');
    const moodAfterEl = document.getElementById('mood-after-value');
    const satisfactionEl = document.getElementById('satisfaction-value');
    
    if (moodBeforeEl) moodBeforeEl.textContent = document.getElementById('mood-before').value;
    if (moodAfterEl) moodAfterEl.textContent = document.getElementById('mood-after').value;
    if (satisfactionEl) satisfactionEl.textContent = document.getElementById('satisfaction-level').value;
  }

  // Funciones para módulo Mindfulness
  let senseExerciseStep = 0;
  let senseTimer;
  const senseSteps = [
    "👀 Encuentra 5 cosas que puedas VER a tu alrededor. Observa sus colores, formas y detalles.",
    "🤚 Encuentra 4 cosas que puedas TOCAR. Nota sus texturas, temperaturas y consistencias.",
    "👂 Encuentra 3 sonidos que puedas OÍR. Escucha tanto sonidos cercanos como lejanos.",
    "👃 Encuentra 2 aromas que puedas OLER. Pueden ser sutiles, toma tu tiempo.",
    "👅 Encuentra 1 sabor que puedas SABOREAR. Puede ser el sabor actual en tu boca."
  ];

  function startFiveSensesExercise() {
    senseExerciseStep = 0;
    document.getElementById('five-senses-guide').classList.remove('hidden');
    showNextSenseStep();
  }

  function showNextSenseStep() {
    if (senseExerciseStep < senseSteps.length) {
      document.getElementById('sense-instruction').innerHTML = senseSteps[senseExerciseStep];
      startSenseTimer();
    } else {
      document.getElementById('sense-instruction').innerHTML = '🌟 ¡Excelente! Has completado el ejercicio de los cinco sentidos. ¿Te sientes más presente y conectado?';
      document.getElementById('next-sense-btn').style.display = 'none';
    }
  }

  function nextSenseStep() {
    senseExerciseStep++;
    showNextSenseStep();
  }

  function startSenseTimer() {
    let seconds = 30;
    const timerEl = document.getElementById('sense-timer');
    
    senseTimer = setInterval(() => {
      seconds--;
      timerEl.textContent = `00:${seconds.toString().padStart(2, '0')}`;
      if (seconds <= 0) {
        clearInterval(senseTimer);
        timerEl.textContent = '00:30';
      }
    }, 1000);
  }

  let walkingTimer;
  function startWalkingTimer() {
    let seconds = 600; // 10 minutos
    const timerEl = document.getElementById('walking-timer');
    
    walkingTimer = setInterval(() => {
      seconds--;
      const minutes = Math.floor(seconds / 60);
      const remainingSeconds = seconds % 60;
      timerEl.textContent = `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
      if (seconds <= 0) {
        clearInterval(walkingTimer);
        alert('¡Caminata mindful completada! ¿Cómo te sentís después de esta práctica consciente?');
        timerEl.textContent = '10:00';
      }
    }, 1000);
  }

  let relaxationTimer;
  let relaxationStep = 0;
  const relaxationSteps = [
    "Acomodate cómodamente. Respirá profundamente 3 veces.",
    "Tensá los músculos de tus pies por 5 segundos, luego relajá completamente.",
    "Tensá los músculos de tus pantorrillas, luego relajá y nota la diferencia.",
    "Tensá los músculos de tus muslos, luego relajá completamente.",
    "Tensá los músculos de tu abdomen, luego relajá y sentí el alivio.",
    "Tensá los músculos de tus brazos, luego relajá completamente.",
    "Tensá los músculos de tus hombros y cuello, luego relajá.",
    "Tensá los músculos de tu rostro, luego relajá completamente.",
    "Hacé un scan corporal completo, notando la relajación en todo tu cuerpo."
  ];

  function startProgressiveRelaxation() {
    relaxationStep = 0;
    document.getElementById('relaxation-guide').classList.remove('hidden');
    showRelaxationStep();
    
    let seconds = 900; // 15 minutos
    const timerEl = document.getElementById('relaxation-timer');
    const progressEl = document.getElementById('relaxation-progress');
    
    relaxationTimer = setInterval(() => {
      seconds--;
      const minutes = Math.floor(seconds / 60);
      const remainingSeconds = seconds % 60;
      timerEl.textContent = `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
      
      const progress = ((900 - seconds) / 900) * 100;
      progressEl.style.width = `${progress}%`;
      
      if (seconds <= 0) {
        clearInterval(relaxationTimer);
        alert('¡Relajación progresiva completada! Tu cuerpo y mente están ahora más relajados.');
        timerEl.textContent = '15:00';
        progressEl.style.width = '0%';
      }
    }, 1000);
    
    // Cambiar instrucciones cada 100 segundos aproximadamente
    setInterval(() => {
      if (relaxationStep < relaxationSteps.length - 1) {
        relaxationStep++;
        showRelaxationStep();
      }
    }, 100000);
  }

  function showRelaxationStep() {
    document.getElementById('relaxation-instruction').textContent = relaxationSteps[relaxationStep];
  }

  // Funciones para módulo ACT
  let selectedValues = [];

  function selectValue(value) {
    const valueCard = event.target.closest('.value-card');
    if (selectedValues.includes(value)) {
      selectedValues = selectedValues.filter(v => v !== value);
      valueCard.classList.remove('selected');
    } else {
      selectedValues.push(value);
      valueCard.classList.add('selected');
    }
    
    if (selectedValues.length > 0) {
      document.getElementById('selected-values').classList.remove('hidden');
      updateValuesList();
    }
  }

  function updateValuesList() {
    const valueNames = {
      family: 'Familia', health: 'Salud', growth: 'Crecimiento', 
      creativity: 'Creatividad', community: 'Comunidad', knowledge: 'Conocimiento',
      spirituality: 'Espiritualidad', adventure: 'Aventura'
    };
    
    const listHtml = selectedValues.map(v => `<span class="value-tag">• ${valueNames[v]}</span>`).join(' ');
    document.getElementById('values-list').innerHTML = listHtml;
  }

  function saveValuesReflection() {
    const reflection = document.getElementById('values-reflection').value.trim();
    if (!reflection) {
      alert('Por favor, escribe una reflexión sobre tus valores.');
      return;
    }
    
    const valueNames = {
      family: 'Familia', health: 'Salud', growth: 'Crecimiento', 
      creativity: 'Creatividad', community: 'Comunidad', knowledge: 'Conocimiento',
      spirituality: 'Espiritualidad', adventure: 'Aventura'
    };
    
    const valuesText = selectedValues.map(v => valueNames[v]).join(', ');
    const journalContent = `EXPLORACIÓN DE VALORES - ACT
Fecha: ${new Date().toLocaleString('es-AR')}
Valores importantes para mí: ${valuesText}
Reflexión: ${reflection}`;

    saveJournalEntryWithPrefix(journalContent);
    document.getElementById('values-reflection').value = '';
    alert('Reflexión sobre valores guardada. ¡Excelente trabajo conectando con lo que es importante para ti!');
  }

  function practiceThanksMind() {
    const thought = prompt("Escribe un pensamiento problemático que tengas:");
    if (thought) {
      alert(`Ahora repite en voz alta o mental: "Gracias, mente, por ese pensamiento de '${thought}'." Nota cómo cambia tu relación con el pensamiento.`);
    }
  }

  function singThought() {
    const thought = document.getElementById('thought-to-sing').value.trim();
    if (!thought) {
      alert('Por favor, escribe un pensamiento primero.');
      return;
    }
    alert(`Ahora canta este pensamiento con la melodía de "Cumpleaños Feliz": "${thought}". ¿Nota cómo pierde su poder emocional?`);
  }

  function reformulateThought() {
    const thought = document.getElementById('original-thought').value.trim();
    if (!thought) {
      alert('Por favor, escribe un pensamiento primero.');
      return;
    }
    
    const reformulated = `Estoy teniendo el pensamiento de que ${thought.toLowerCase()}`;
    document.getElementById('reformulated-thought').innerHTML = `
      <strong>Pensamiento reformulado:</strong><br>
      "${reformulated}"<br>
      <em>¿Notás cómo esto crea distancia del pensamiento?</em>
    `;
    document.getElementById('reformulated-thought').classList.remove('hidden');
  }

  let committedActions = JSON.parse(localStorage.getItem('committedActions') || '[]');

  function saveCommittedAction() {
    const value = document.getElementById('chosen-value').value;
    const action = document.getElementById('specific-action').value.trim();
    const when = document.getElementById('action-when').value;
    const obstacles = document.getElementById('emotional-obstacles').value.trim();
    const commitment = document.getElementById('commitment-level').value;

    if (!value || !action || !when) {
      alert('Por favor, completa al menos el valor, la acción y cuándo la vas a hacer.');
      return;
    }

    const newAction = {
      value, action, when, obstacles, commitment: parseInt(commitment),
      date: new Date().toLocaleString('es-AR'),
      completed: false
    };

    committedActions.push(newAction);
    localStorage.setItem('committedActions', JSON.stringify(committedActions));
    
    // Limpiar formulario
    document.getElementById('chosen-value').value = '';
    document.getElementById('specific-action').value = '';
    document.getElementById('action-when').value = '';
    document.getElementById('emotional-obstacles').value = '';
    document.getElementById('commitment-level').value = 8;
    updateCommitmentValue();
    
    displayCommittedActions();
    alert('¡Compromiso creado! Recorda que es importante seguir con la acción incluso si no te sentís motivado/a.');
  }

  function updateCommitmentValue() {
    const valueEl = document.getElementById('commitment-value');
    if (valueEl) valueEl.textContent = document.getElementById('commitment-level').value;
  }

  function displayCommittedActions() {
    const container = document.getElementById('actions-entries');
    if (committedActions.length === 0) {
      container.innerHTML = '<p class="text-gray-500">No tienes compromisos creados todavía.</p>';
      return;
    }

    container.innerHTML = committedActions.slice(-5).reverse().map((action, index) => `
      <div class="behavior-entry">
        <strong>${action.action}</strong><br>
        Valor: ${action.value} | Compromiso: ${action.commitment}/10<br>
        Fecha programada: ${new Date(action.when).toLocaleString('es-AR')}<br>
        ${action.obstacles ? `Obstáculos previstos: ${action.obstacles}` : ''}
      </div>
    `).join('');
  }

  function updateFlexibilityScore() {
    const q1 = parseInt(document.getElementById('q1').value);
    const q2 = parseInt(document.getElementById('q2').value);
    const q3 = parseInt(document.getElementById('q3').value);
    const q4 = parseInt(document.getElementById('q4').value);
    const q5 = parseInt(document.getElementById('q5').value);
    
    // Update individual displays
    document.getElementById('q1-value').textContent = q1;
    document.getElementById('q2-value').textContent = q2;
    document.getElementById('q3-value').textContent = q3;
    document.getElementById('q4-value').textContent = q4;
    document.getElementById('q5-value').textContent = q5;
    
    const total = q1 + q2 + q3 + q4 + q5;
    document.getElementById('flexibility-score').textContent = total;
    
    let feedback = '';
    if (total >= 20) {
      feedback = '🌟 Excelente flexibilidad psicológica. Continúa practicando estas habilidades.';
    } else if (total >= 15) {
      feedback = '👍 Buena flexibilidad psicológica. Hay áreas que pueden mejorar con práctica.';
    } else if (total >= 10) {
      feedback = '⚠️ Flexibilidad moderada. Considera practicar más técnicas de ACT.';
    } else {
      feedback = '🔄 La flexibilidad psicológica se puede desarrollar. Te recomendamos practicar regularmente estas técnicas.';
    }
    
    document.getElementById('flexibility-feedback').innerHTML = feedback;
  }

  // Funciones para Musicoterapia
  let frequencyAudios = {};

  function playFrequency(freq) {
    const iconId = `freq-${freq}-icon`;
    const icon = document.getElementById(iconId);
    
    if (icon.classList.contains('fa-play')) {
      // Simular reproducción de frecuencia (en una app real usarías Web Audio API)
      icon.classList.remove('fa-play');
      icon.classList.add('fa-pause');
      
      // Simular audio
      alert(`🎵 Reproduciendo frecuencia ${freq} Hz. En una implementación real, esto reproduciría la frecuencia terapéutica usando Web Audio API.`);
      
      // Auto-parar después de unos segundos para demo
      setTimeout(() => {
        icon.classList.remove('fa-pause');
        icon.classList.add('fa-play');
      }, 5000);
    } else {
      stopFrequency(freq);
    }
  }

  function stopFrequency(freq) {
    const iconId = `freq-${freq}-icon`;
    const icon = document.getElementById(iconId);
    icon.classList.remove('fa-pause');
    icon.classList.add('fa-play');
  }

  let heartDrumTimer;
  function startHeartDrumming() {
    document.getElementById('heart-drum-guide').classList.remove('hidden');
    const circle = document.getElementById('heart-drum-circle');
    
    let phase = 'inhale';
    let seconds = 300; // 5 minutos
    
    const drumPattern = setInterval(() => {
      if (phase === 'inhale') {
        circle.style.transform = 'scale(1.2)';
        circle.style.backgroundColor = '#4361ee';
        document.getElementById('drum-instruction').textContent = 'Inhala con el latido ♥';
        phase = 'exhale';
      } else {
        circle.style.transform = 'scale(1)';
        circle.style.backgroundColor = '#3a0ca3';
        document.getElementById('drum-instruction').textContent = 'Exhala con el latido ♥';
        phase = 'inhale';
      }
    }, 1000); // Latido cada segundo
    
    heartDrumTimer = setInterval(() => {
      seconds--;
      const minutes = Math.floor(seconds / 60);
      const remainingSeconds = seconds % 60;
      document.getElementById('drum-timer').textContent = 
        `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
      
      if (seconds <= 0) {
        clearInterval(heartDrumTimer);
        clearInterval(drumPattern);
        document.getElementById('drum-timer').textContent = '05:00';
        alert('¡Ejercicio de tambor cardíaco completado! ¿Sientes tu corazón más calmado?');
      }
    }, 1000);
  }

  let metronomeTimer;
  function startMetronomeBreathing() {
    const bpm = document.getElementById('bpm-slider').value;
    const interval = 60000 / bpm; // ms per beat
    
    document.getElementById('metronome-guide').classList.remove('hidden');
    const circle = document.getElementById('metronome-circle');
    
    let phase = 'inhale';
    let seconds = 300; // 5 minutos
    
    const metronome = setInterval(() => {
      if (phase === 'inhale') {
        circle.textContent = 'Exhalar';
        circle.style.transform = 'scale(0.8)';
        phase = 'exhale';
      } else {
        circle.textContent = 'Inhalar';
        circle.style.transform = 'scale(1.2)';
        phase = 'inhale';
      }
    }, interval);
    
    metronomeTimer = setInterval(() => {
      seconds--;
      const minutes = Math.floor(seconds / 60);
      const remainingSeconds = seconds % 60;
      document.getElementById('metronome-timer').textContent = 
        `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
      
      if (seconds <= 0) {
        clearInterval(metronomeTimer);
        clearInterval(metronome);
        document.getElementById('metronome-timer').textContent = '05:00';
        alert('¡Respiración con metrónomo completada! Tu sistema nervioso está más regulado.');
      }
    }, 1000);
  }

  function updateBPMValue() {
    const bpmValue = document.getElementById('bpm-slider').value;
    document.getElementById('bpm-value').textContent = bpmValue;
  }

  function playMantra(mantra) {
    const mantras = {
      om: 'OM - Repite este sonido sagrado por 1 minuto, sintiendo su vibración.',
      soham: 'SO HAM - Inhala "SO", exhala "HAM". Significa "Yo soy eso".',
      peace: 'QUE HAYA PAZ - Repite con intención amorosa por 2 minutos.',
      love: 'QUE TODOS LOS SERES SEAN FELICES - Cultiva compasión universal.'
    };
    
    alert(`🎵 ${mantras[mantra]}`);
  }

  function toneVowel(vowel) {
    const vowelInfo = {
      A: 'Ahhhh - Abre el corazón. Haz este sonido por 30 segundos.',
      E: 'Eeee - Limpia la garganta. Vibra en tu cuello.',
      I: 'Iiiii - Activa la mente. Siente la vibración en tu cabeza.',
      O: 'Oooo - Expande el pecho. Vibra en tu torso.',
      U: 'Uuuu - Centra el abdomen. Siente la vibración profunda.'
    };
    
    document.getElementById('vowel-instruction').innerHTML = `
      <h4>Vocal ${vowel}</h4>
      <p>${vowelInfo[vowel]}</p>
    `;
    document.getElementById('vowel-instruction').classList.remove('hidden');
  }

  const musicRecommendations = {
    anxiety: {
      title: '🌬️ Música para Ansiedad',
      description: 'Música específicamente diseñada para reducir la ansiedad y promover la calma.',
      playlist: [
        'Sonidos de naturaleza con frecuencias bajas',
        'Música clásica baroque (60-70 BPM)',
        'Ambient music con drones sostened',
        'Sonidos binaurales alpha (8-12 Hz)'
      ]
    },
    sadness: {
      title: '🌧️ Música para Tristeza',
      description: 'Música que honra la tristeza y gradualmente eleva el ánimo.',
      playlist: [
        'Música clásica melancólica (Chopin, Barber)',
        'Sonidos de lluvia y océano',
        'Música folk acústica suave',
        'Gradualmente: música más alegre'
      ]
    },
    anger: {
      title: '🔥 Música para Ira',
      description: 'Música que ayuda a procesar y liberar la ira de forma saludable.',
      playlist: [
        'Inicio: música que coincida con tu energía',
        'Tambores africanos para liberar tensión',
        'Música instrumental intensa',
        'Gradualmente: música más calmante'
      ]
    },
    stress: {
      title: '⚡ Música para Estrés',
      description: 'Música científicamente probada para reducir el cortisol y el estrés.',
      playlist: [
        'Música a 60 BPM para sincronizar ritmo cardíaco',
        'Sonidos de agua corriente',
        'Música new age instrumental',
        'Frecuencias 528 Hz (reparadoras)'
      ]
    },
    grief: {
      title: '💔 Música para Duelo',
      description: 'Música que acompaña el proceso de duelo con compasión.',
      playlist: [
        'Música espiritual tranquila',
        'Sonidos de campanas tibetanas',
        'Música clásica reflexiva',
        'Canciones que honren la memoria'
      ]
    },
    peace: {
      title: '🕊️ Música para Paz',
      description: 'Música para cultivar la paz interior y la serenidad.',
      playlist: [
        'Música meditativa con cuencos tibetanos',
        'Cantos gregorianos o mantras',
        'Sonidos de naturaleza (bosque, océano)',
        'Música ambient espacial'
      ]
    }
  };

  function selectMusicMood(mood) {
    const recommendation = musicRecommendations[mood];
    document.getElementById('music-recommendation').classList.remove('hidden');
    document.getElementById('music-mood-title').textContent = recommendation.title;
    document.getElementById('music-description').textContent = recommendation.description;
    
    const playlistHtml = recommendation.playlist.map(item => 
      `<div class="technique-step">🎵 ${item}</div>`
    ).join('');
    document.getElementById('music-playlist').innerHTML = playlistHtml;
  }

  // Event listeners para los sliders de comportamiento
  document.addEventListener('DOMContentLoaded', function() {
    const moodBeforeSlider = document.getElementById('mood-before');
    const moodAfterSlider = document.getElementById('mood-after');
    const satisfactionSlider = document.getElementById('satisfaction-level');
    const commitmentSlider = document.getElementById('commitment-level');
    const bpmSlider = document.getElementById('bpm-slider');
    
    if (moodBeforeSlider) {
      moodBeforeSlider.addEventListener('input', updateMoodValues);
      moodAfterSlider.addEventListener('input', updateMoodValues);
      satisfactionSlider.addEventListener('input', updateMoodValues);
      displayBehaviorEntries();
    }
    
    if (commitmentSlider) {
      commitmentSlider.addEventListener('input', updateCommitmentValue);
      displayCommittedActions();
    }
    
    if (bpmSlider) {
      bpmSlider.addEventListener('input', updateBPMValue);
    }
    
    // Inicializar evaluación de flexibilidad
    if (document.getElementById('q1')) {
      updateFlexibilityScore();
    }
  });
  
  });
</script>
</body>
</html>
